<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>安全审计之Pandas常用代码 | sh1yan&#39;blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="description" content="0x00 前言 在审计中除了使用Excel和SQL来进行处理分析一些数据，也会经常用到Pandas来做一些分析，而使用Pandas做分析的定位主要分为两点：1、当数据量过大的时候，普通Excel已经很难便捷的进行审计分析；2、当审计场景已经流程化，则需要固话成自动化的时候。">
<meta name="keywords" content="Python,pandas">
<meta property="og:type" content="article">
<meta property="og:title" content="安全审计之Pandas常用代码">
<meta property="og:url" content="sh1yan.top/2020/05/22/Common-codes-of-pandas-in-security-audit/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="0x00 前言 在审计中除了使用Excel和SQL来进行处理分析一些数据，也会经常用到Pandas来做一些分析，而使用Pandas做分析的定位主要分为两点：1、当数据量过大的时候，普通Excel已经很难便捷的进行审计分析；2、当审计场景已经流程化，则需要固话成自动化的时候。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-05-22T09:53:52.614Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="安全审计之Pandas常用代码">
<meta name="twitter:description" content="0x00 前言 在审计中除了使用Excel和SQL来进行处理分析一些数据，也会经常用到Pandas来做一些分析，而使用Pandas做分析的定位主要分为两点：1、当数据量过大的时候，普通Excel已经很难便捷的进行审计分析；2、当审计场景已经流程化，则需要固话成自动化的时候。">
  
    <link rel="alternative" href="/atom.xml" title="sh1yan&#39;blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/gossip">Gossip</a>
        
          <a class="main-nav-link" href="/yqlj">Links</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="sh1yan.top"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Common-codes-of-pandas-in-security-audit" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/22/Common-codes-of-pandas-in-security-audit/" class="article-date">
  <time datetime="2020-05-22T15:50:55.000Z" itemprop="datePublished">2020-05-22</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/安全审计/">安全审计</a>
  </div>


  </div>
  <div class="article-inner">
    

    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      安全审计之Pandas常用代码
    </h1>
  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="article-sharing">
  <ul>
    <li>
      <div class="fb-like" data-send="false" data-layout="button_count" data-show-faces="false" data-font="verdana" data-href="sh1yan.top/2020/05/22/Common-codes-of-pandas-in-security-audit/"></div>
    </li>
  </ul>
</div>

      
      
        
        <p><strong>0x00 前言</strong></p>
<p>在审计中除了使用Excel和SQL来进行处理分析一些数据，也会经常用到Pandas来做一些分析，而使用Pandas做分析的定位主要分为两点：1、当数据量过大的时候，普通Excel已经很难便捷的进行审计分析；2、当审计场景已经流程化，则需要固话成自动化的时候。</p>
<a id="more"></a>
<p>以下是我收集整理的代码组合，代码非原创（我是代码搬运工）。</p>
<p><strong>0x01 常用的代码组合</strong></p>
<p><strong>1. 数据去重：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data.drop_duplicates(subset=[<span class="string">'A'</span>,<span class="string">'B'</span>],keep=<span class="string">'first'</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">代码中subset对应的值是列名，表示只考虑这两列，将这两列对应值相同的行进行去重。</span><br><span class="line">默认值为subset=<span class="literal">None</span>表示考虑所有列。</span><br><span class="line"></span><br><span class="line">keep=<span class="string">'first'</span>表示保留第一次出现的重复行，是默认值。keep另外两个取值为<span class="string">"last"</span>和<span class="literal">False</span>，</span><br><span class="line">分别表示保留最后一次出现的重复行和去除所有重复行。</span><br><span class="line"></span><br><span class="line">inplace=<span class="literal">True</span>表示直接在原来的DataFrame上删除重复项，而默认值<span class="literal">False</span>表示生成一个副本。</span><br></pre></td></tr></table></figure>
<p><strong>2. 透视表 - pivot_table</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pivot_table(data, values=<span class="literal">None</span>, index=<span class="literal">None</span>, columns=<span class="literal">None</span>,aggfunc=<span class="string">'mean'</span>, fill_value=<span class="literal">None</span>, margins=<span class="literal">False</span>, dropna=<span class="literal">True</span>, margins_name=<span class="string">'All'</span>)</span><br><span class="line"></span><br><span class="line">pivot_table有四个最重要的参数index、values、columns、aggfunc</span><br><span class="line"></span><br><span class="line">index：Excel透视表中‘行’，主键位。</span><br><span class="line"></span><br><span class="line">values：Excel透视表中‘值’，统计位。</span><br><span class="line"></span><br><span class="line">columns：Excel透视表中‘列’，没杂用过位。</span><br><span class="line"></span><br><span class="line">aggfunc：设置函数位，默认为mean（计算均值），常用函数为count或者使用numpy的sum函数。</span><br><span class="line"></span><br><span class="line">data1=pd.pivot_table(data,index=[<span class="string">'主账号'</span>],values=[<span class="string">'源IP地址'</span>],aggfunc=<span class="string">'count'</span>)<span class="comment"># 做数据透视表</span></span><br><span class="line"></span><br><span class="line">data_account_num=pd.pivot_table(data,index=[<span class="string">'XXX1'</span>,<span class="string">'XXX2'</span>,<span class="string">"XXX3"</span>],values=[<span class="string">'XXX4'</span>],aggfunc=<span class="string">'count'</span>)<span class="comment"># 做数据透视表</span></span><br><span class="line">data_account_num.rename(columns=&#123;<span class="string">'XXX1'</span>:<span class="string">'XXX2'</span>&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line">data_add=data_account_num.sort_values(<span class="string">'XXX'</span>,ascending=<span class="literal">False</span>)  <span class="comment"># 按某列进行排序</span></span><br></pre></td></tr></table></figure>
<p><strong>3. 筛选透视表中值大于1的数据，并排序：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data1[data1[<span class="string">'值'</span>]&gt;<span class="number">1</span>].sort_values(<span class="string">'值'</span>,ascending=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><strong>4. 按索引值进行合并两张表</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">pd.merge(data1,data2,right_on=<span class="string">'主账号'</span>,left_index=<span class="literal">True</span>,how=<span class="string">'right'</span>).sort_values(<span class="string">'主账号'</span>,ascending=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">pandas.merge(left, right, how: str = <span class="string">'inner'</span>, on=<span class="literal">None</span>, left_on=<span class="literal">None</span>, right_on=<span class="literal">None</span>, left_index: bool = <span class="literal">False</span>, right_index: bool = <span class="literal">False</span>, sort: bool = <span class="literal">False</span>, suffixes=(<span class="string">'_x'</span>, <span class="string">'_y'</span>), copy: bool = <span class="literal">True</span>, indicator: bool = <span class="literal">False</span>, validate=<span class="literal">None</span>) → <span class="string">'DataFrame'</span></span><br><span class="line"></span><br><span class="line">left：   参与合并的左侧DataFranme</span><br><span class="line">right：  参与合并的右侧DataFranme</span><br><span class="line">how：    默认为inner，可设为inner/outer/left/right</span><br><span class="line">on：     根据某个字段进行连接，必须存在于两个DateFrame中（若未同时存在，则需要分别使用left_on和right_on来设置）</span><br><span class="line">left_on：      左连接，以DataFrame1中用作连接键的列</span><br><span class="line">right_on：     右连接，以DataFrame2中用作连接键的列</span><br><span class="line">left_index：   将DataFrame1行索引用作连接键</span><br><span class="line">right_index：  将DataFrame2行索引用作连接键</span><br><span class="line">sort：         根据连接键对合并后的数据进行排列，默认为<span class="literal">True</span></span><br><span class="line">suffixes：     对两个数据集中出现的重复列，新数据集中加上后缀_x,_y进行区别</span><br><span class="line"></span><br><span class="line"><span class="number">4.1</span> 内连接(Inner)</span><br><span class="line"></span><br><span class="line">pd.merge(data1,data2, left_on=<span class="string">'主账号'</span>,right_on=<span class="string">'主账号'</span>).sort_values(<span class="string">'主账号'</span>,ascending=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">注：以最少数的表为索引表</span><br><span class="line"></span><br><span class="line"><span class="number">4.2</span> 右链接(Right)</span><br><span class="line"></span><br><span class="line">pd.merge(data1,data2, right_on=<span class="string">'主账号'</span>,left_on=<span class="string">'主账号'</span>,how=<span class="string">'right'</span>).sort_values(<span class="string">'主账号'</span>,ascending=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">4.3</span> 左链接(Left)</span><br><span class="line"></span><br><span class="line">pd.merge(data1,data2, right_on=<span class="string">'主账号'</span>,left_on=<span class="string">'主账号'</span>,how=<span class="string">'left'</span>).sort_values(<span class="string">'主账号'</span>,ascending=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">4.4</span> 全链接(Outer)</span><br><span class="line"></span><br><span class="line">pd.merge(data1,data2, right_on=<span class="string">'主账号'</span>,left_on=<span class="string">'主账号'</span>,how=<span class="string">'outer'</span>).sort_values(<span class="string">'主账号'</span>,ascending=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><strong>5. 两个Excel表进行合并</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pd.concat(objs, axis=<span class="number">0</span>, join=<span class="string">'outer'</span>, join_axes=<span class="literal">None</span>, ignore_index=<span class="literal">False</span>,keys=<span class="literal">None</span>, levels=<span class="literal">None</span>, names=<span class="literal">None</span>, verify_integrity=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">concat函数是在pandas底下的方法，可以将数据根据不同的轴作简单的融合</span><br><span class="line"></span><br><span class="line">objs: series，dataframe或者是panel构成的序列lsit</span><br><span class="line">axis： 需要合并链接的轴，<span class="number">0</span>是行，<span class="number">1</span>是列</span><br><span class="line">join：连接的方式 inner，或者outer</span><br><span class="line"></span><br><span class="line">data5 = pd.concat([data3,data4],axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><strong>6. 筛选匹配固定字符内容</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># 导包 </span></span><br><span class="line">data=pd.read_csv(<span class="string">'0201-0303-674286.csv'</span>) </span><br><span class="line">data=data[data[<span class="string">'操作命令'</span>].isnull().values == <span class="literal">False</span>] <span class="comment"># 匹配的内容字段中不能用空值，该行代码解决</span></span><br><span class="line">data1=data[data[<span class="string">'主帐号ID'</span>].str.contains(<span class="string">'shiyan520'</span>)]</span><br></pre></td></tr></table></figure>
<p><strong>7. 导入相关日志文件</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># 导包 </span></span><br><span class="line"></span><br><span class="line">data=pd.read_excel(<span class="string">'XXX.xlsx'</span>) <span class="comment"># 读取excel文件</span></span><br><span class="line">data=pd.read_csv(<span class="string">'XXX.csv'</span>) </span><br><span class="line">data=pd.read_csv(open(<span class="string">'XXX.csv'</span>,encoding=<span class="string">'utf-8'</span>)，sheet_name=<span class="string">'XXX'</span>).iloc[:,:<span class="number">-1</span>] <span class="comment"># 读取csv文件</span></span><br></pre></td></tr></table></figure>
<p><strong>8. 导出相关审计结果</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data1.to_excel(<span class="string">'111.xlsx'</span>,index=<span class="number">0</span>) <span class="comment"># 输出excel文件 </span></span><br><span class="line">data1.to_csv(<span class="string">'222.csv'</span>,encoding=<span class="string">'utf-8'</span>,index=<span class="number">0</span>) <span class="comment"># 输出csv文件，可指定文件编码</span></span><br></pre></td></tr></table></figure>
<p><strong>9. 筛选大于或小于某时间节点数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data1=data[data[<span class="string">'TIME'</span>]&lt;<span class="string">'08:00:00:000'</span>]</span><br><span class="line">data2=data[data[<span class="string">'TIME'</span>]&gt;<span class="string">'21:00:00:000'</span>]</span><br></pre></td></tr></table></figure>
<p><strong>10. 解决主账号ID或从账号ID中存在空格的情况</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judge</span><span class="params">(a)</span>:</span><span class="comment"># 自定义向量化处理数据</span></span><br><span class="line">    <span class="keyword">return</span> a.rstrip()</span><br><span class="line">data[<span class="string">'主帐号'</span>]=data.apply(<span class="keyword">lambda</span> data:judge(data[<span class="string">'主帐号ID'</span>]),axis=<span class="number">1</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judge</span><span class="params">(a)</span>:</span><span class="comment"># 自定义向量化处理数据</span></span><br><span class="line">    <span class="keyword">return</span> a.rstrip()</span><br><span class="line">data[<span class="string">'从帐号ID'</span>]=data.apply(<span class="keyword">lambda</span> data:judge(data[<span class="string">'从帐号'</span>]),axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line"><span class="string">'xxxxxx'</span>.strip(to_strip=<span class="literal">None</span>)去除两边空白</span><br><span class="line"><span class="string">'xxxxxx'</span>.lstrip(to_strip=<span class="literal">None</span>)去除左边空白</span><br><span class="line"><span class="string">'xxxxxx'</span>.rstrip(to_strip=<span class="literal">None</span>)去除右边空白</span><br></pre></td></tr></table></figure>
<p><strong>11. 删除某条或某规则下数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> data[<span class="string">'从帐号'</span>]</span><br><span class="line"><span class="keyword">del</span> data [<span class="string">'主帐号ID'</span>]</span><br></pre></td></tr></table></figure>
<p><strong>12. 单字段进行去重</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data1=data[<span class="string">'主帐号ID'</span>]</span><br><span class="line">data2=data1[-data1.duplicated()]</span><br></pre></td></tr></table></figure>
<p><strong>13. 重复数据与现有数据统计</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data_chongfu=data1[data1.duplicated()].count()[<span class="number">0</span>]</span><br><span class="line">print(<span class="string">'重复数据有%s行'</span>%data_chongfu) <span class="comment"># 查看表重复数量</span></span><br><span class="line">data2=data1[-data1.duplicated()] <span class="comment"># 剔除重复数据</span></span><br><span class="line">print(<span class="string">'现有数据有%s行'</span>%data2.shape[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p><strong>14. 删除某行或某列或某条件下数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">drop方法的用法：drop(labels, axis=<span class="number">0</span>, level=<span class="literal">None</span>, inplace=<span class="literal">False</span>, errors=<span class="string">'raise'</span>)</span><br><span class="line">--  axis为<span class="number">0</span>时表示删除行，axis为<span class="number">1</span>时表示删除列</span><br><span class="line">--  labels接受String或Array。代表删除的行或列的标签。无默认</span><br><span class="line">-- levels接受int或者索引名。代表标签所在级别。默认为<span class="literal">None</span>。</span><br><span class="line">-- inplace接受boolean。代表操作是否对原数据生效。默认为<span class="literal">False</span>。</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;<span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">&gt;&gt;&gt;<span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">&gt;&gt;&gt;df = pd.DataFrame(np.arange(<span class="number">12</span>).reshape(<span class="number">3</span>,<span class="number">4</span>), columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br><span class="line">&gt;&gt;&gt;df</span><br><span class="line">   A   B   C   D</span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2</span>  <span class="number">8</span>   <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="comment">#Drop columns,两种方法等价</span></span><br><span class="line">&gt;&gt;&gt;df.drop([<span class="string">'B'</span>, <span class="string">'C'</span>], axis=<span class="number">1</span>)</span><br><span class="line">   A   D</span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2</span>  <span class="number">8</span>  <span class="number">11</span></span><br><span class="line">&gt;&gt;&gt;df.drop(columns=[<span class="string">'B'</span>, <span class="string">'C'</span>])</span><br><span class="line">   A   D</span><br><span class="line"><span class="number">0</span>  <span class="number">0</span>   <span class="number">3</span></span><br><span class="line"><span class="number">1</span>  <span class="number">4</span>   <span class="number">7</span></span><br><span class="line"><span class="number">2</span>  <span class="number">8</span>  <span class="number">11</span></span><br><span class="line"><span class="comment"># 第一种方法下删除column一定要指定axis=1,否则会报错</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.drop([<span class="string">'B'</span>, <span class="string">'C'</span>])</span><br><span class="line">ValueError: labels [<span class="string">'B'</span> <span class="string">'C'</span>] <span class="keyword">not</span> contained <span class="keyword">in</span> axis</span><br><span class="line"><span class="comment">#Drop rows</span></span><br><span class="line">&gt;&gt;&gt;df.drop([<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">   A  B   C   D</span><br><span class="line"><span class="number">2</span>  <span class="number">8</span>  <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.drop(index=[<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">   A  B   C   D</span><br><span class="line"><span class="number">2</span>  <span class="number">8</span>  <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></span><br><span class="line"></span><br><span class="line">-------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame([[<span class="string">'Snow'</span>,<span class="string">'M'</span>,<span class="number">22</span>],[<span class="string">'Tyrion'</span>,<span class="string">'M'</span>,<span class="number">32</span>],[<span class="string">'Sansa'</span>,<span class="string">'F'</span>,<span class="number">18</span>],[<span class="string">'Arya'</span>,<span class="string">'F'</span>,<span class="number">14</span>]], columns=[<span class="string">'name'</span>,<span class="string">'gender'</span>,<span class="string">'age'</span>])</span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'---------删除行或列:DataFrame.drop()--------'</span>)</span><br><span class="line"><span class="comment"># drop默认对原表不生效，如果要对原表生效，需要加参数：inplace=True</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"----删除单行----"</span>)</span><br><span class="line">df2=df1.drop(labels=<span class="number">0</span>)   <span class="comment"># axis默认等于0，即按行删除，这里表示按行删除第0行</span></span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"------删除多行------"</span>)</span><br><span class="line"><span class="comment"># 通过labels来控制删除行或列的个数，如果是删多行/多列，需写成labels=[1,3]，不能写成labels=[1:2],用:号会报错</span></span><br><span class="line"><span class="comment"># 删除指定的某几行（非连续的）</span></span><br><span class="line">df21=df1.drop(labels=[<span class="number">1</span>,<span class="number">3</span>],axis=<span class="number">0</span>)   <span class="comment"># axis=0 表示按行删除，删除第1行和第3行</span></span><br><span class="line">print(df21)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要删除连续的多行可以用range(),删除连续的多列不能用此方法</span></span><br><span class="line">df22=df1.drop(labels=range(<span class="number">1</span>,<span class="number">4</span>),axis=<span class="number">0</span>)   <span class="comment"># axis=0 表示按行删除，删除索引值是第1行至第3行的正行数据</span></span><br><span class="line">print(df22)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"----删除单列----"</span>)</span><br><span class="line">df3=df1.drop(labels=<span class="string">'gender'</span>,axis=<span class="number">1</span>)  <span class="comment"># axis=1 表示按列删除，删除gender列</span></span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"----删除多列----"</span>)</span><br><span class="line"><span class="comment"># 删除指定的某几列</span></span><br><span class="line">df4=df1.drop(labels=[<span class="string">'gender'</span>,<span class="string">"age"</span>],axis=<span class="number">1</span>)  <span class="comment"># axis=1 表示按列删除，删除gender、age列</span></span><br><span class="line">print(df4)</span><br></pre></td></tr></table></figure>
<p><strong>15. 导入某文件夹中同类型数据文件</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">list=glob.glob(<span class="string">'*'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list:print(<span class="string">'【'</span>+i+<span class="string">'】'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看文件夹内，同类csv的所有字段</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># 导包 </span></span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">list=glob.glob(<span class="string">'*.csv'</span>)</span><br><span class="line">file=glob.glob(<span class="string">'*.csv'</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list:</span><br><span class="line">    print(<span class="string">'【'</span>+i+<span class="string">'】'</span>)</span><br><span class="line">    data=pd.read_csv(i)</span><br><span class="line">    print(data.columns.tolist())</span><br></pre></td></tr></table></figure>
<p><strong>16. 处理操作日志中重复数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">file=<span class="string">'xxxxxxx.csv'</span></span><br><span class="line">data1=pd.read_csv(file)</span><br><span class="line">print(<span class="string">'原始数据有%s行'</span>%data1.shape[<span class="number">0</span>])</span><br><span class="line">data_chongfu=data1[data1.duplicated()].count()[<span class="number">0</span>]</span><br><span class="line">print(<span class="string">'重复数据有%s行'</span>%data_chongfu) <span class="comment"># 查看表重复数量</span></span><br><span class="line">data2=data1[-data1.duplicated()] <span class="comment"># 剔除重复数据</span></span><br><span class="line">print(<span class="string">'现有数据有%s行'</span>%data2.shape[<span class="number">0</span>])</span><br><span class="line">data_sum=data_chongfu+data2.shape[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># print('重复数据+现有数据：%s+%s=%s'%(data_chongfu,data2.shape[0],data_sum))</span></span><br><span class="line">print(<span class="string">'原始数据有%s行，重复数据+现有数据%s行'</span>%(data1.shape[<span class="number">0</span>],data_sum))</span><br><span class="line">file_new=file[:<span class="number">18</span>]+<span class="string">'共%s条_原有%s条_已去重%s条.csv'</span>%(data2.shape[<span class="number">0</span>],data1.shape[<span class="number">0</span>],data_chongfu)</span><br><span class="line">data2.to_csv(file_new,index=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><strong>17. 合并字段</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">'XXX+XXX'</span>]=data[<span class="string">'XXX'</span>]+data[<span class="string">'XXX'</span>] <span class="comment"># 合并字段</span></span><br></pre></td></tr></table></figure>
<p><strong>18. 重命名字段</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data.rename(columns=&#123;<span class="string">'XXX'</span>:<span class="string">'XXX'</span>&#125;,inplace=<span class="literal">True</span>) <span class="comment"># 进行重命名</span></span><br></pre></td></tr></table></figure>
<p><strong>19. 对日志中某字段数进行排序并筛选大于某值的数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data.sort_values(by=<span class="string">'XXX'</span>,ascending=<span class="literal">False</span>)</span><br><span class="line">data=data[data[<span class="string">'XXX'</span>]&gt;<span class="number">3</span>].sort_values(<span class="string">'XXX'</span>,ascending=<span class="literal">True</span>) <span class="comment"># 将账号大于3的筛选并正排序</span></span><br></pre></td></tr></table></figure>
<p><strong>20. 部分取值相关代码</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data.columns.tolist() <span class="comment"># 取所有列名为一个列表</span></span><br><span class="line"></span><br><span class="line">data.max()-data.min() <span class="comment"># 取每列的最大值和最小值的差值，里边注意不能有值是字符串型的</span></span><br><span class="line"></span><br><span class="line">data1=data.iloc[:,<span class="number">1</span>:] <span class="comment"># 取除第一列外的所有数据</span></span><br></pre></td></tr></table></figure>
<p><strong>21. Pandas链接数据库</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入必要模块</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化数据库连接，使用pymysql模块</span></span><br><span class="line"><span class="comment"># MySQL的用户：root, 密码:root, 端口：3306,数据库：mydba</span></span><br><span class="line">engine = create_engine(<span class="string">'mysql+pymysql://root@localhost:3306/operation'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询语句，选出employee表中的所有数据</span></span><br><span class="line">sql = <span class="string">'''</span></span><br><span class="line"><span class="string">      select * from work_operation;</span></span><br><span class="line"><span class="string">      '''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># read_sql_query的两个参数: sql语句， 数据库连接</span></span><br><span class="line">df = pd.read_sql_query(sql, engine)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出employee表的查询结果</span></span><br><span class="line"><span class="comment"># print(df)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # 新建pandas中的DataFrame, 只有id,num两列</span></span><br><span class="line"><span class="comment"># df = pd.DataFrame(&#123;'id':[1,2,3,4],'num':[12,34,56,89]&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # 将新建的DataFrame储存为MySQL中的数据表，不储存index列</span></span><br><span class="line"><span class="comment"># df.to_sql('mydf', engine, index= False)</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'Read from and write to Mysql table successfully!'</span>)</span><br><span class="line">         </span><br><span class="line">Series中的str处理</span><br><span class="line"></span><br><span class="line"><span class="comment"># Series.str 常用的属性和方法有rstrip，.contains，split，upper，count，replace，extract等</span></span><br><span class="line"></span><br><span class="line">addr = pd.Series([</span><br><span class="line"><span class="string">'Washington, D.C. 20003'</span>,</span><br><span class="line"><span class="string">'Brooklyn, NY 11211-1755'</span>,</span><br><span class="line"><span class="string">'Omaha, NE 68154'</span>,</span><br><span class="line"><span class="string">'Pittsburgh, PA 15211'</span>]) <span class="comment"># 数据例子</span></span><br><span class="line"></span><br><span class="line">addr.str.upper() <span class="comment"># 将所有的字符串变为大写</span></span><br><span class="line">addr.str.count(<span class="string">r'\d'</span>) <span class="comment"># 计算出数字有多少个</span></span><br><span class="line"></span><br><span class="line">regex = (<span class="string">r'(?P&lt;city&gt;[A-Za-z ]+), '</span> <span class="comment"># 一个或更多字母</span></span><br><span class="line"><span class="string">r'(?P&lt;state&gt;[A-Z]&#123;2&#125;) '</span>        <span class="comment"># 两个大写字母</span></span><br><span class="line"><span class="string">r'(?P&lt;zip&gt;\d&#123;5&#125;(?:-\d&#123;4&#125;)?)'</span>)  <span class="comment"># 可选的4个延伸数字</span></span><br><span class="line">addr.str.replace(<span class="string">'.'</span>, <span class="string">''</span>).str.extract(regex) <span class="comment"># 将.替换为空，并用正则提出来有效信息，变为dataframe</span></span><br></pre></td></tr></table></figure>
<p><strong>22. 统计处理时长</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment">#程序开始时：</span></span><br><span class="line">sum_begin = datetime.datetime.now()</span><br><span class="line"></span><br><span class="line"><span class="comment">#程序结束时：</span></span><br><span class="line">sum_end = datetime.datetime.now()</span><br><span class="line">sum_run_time = str((sum_end-sum_begin).seconds)</span><br><span class="line">print(<span class="string">"用时:"</span> + sum_run_time +<span class="string">"秒"</span>)</span><br></pre></td></tr></table></figure>
<p><strong>23. 读取第一行做表头，指定添加字段名称</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">pd.read_csv(file, header=<span class="literal">None</span>, names = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>] )</span><br><span class="line"></span><br><span class="line"><span class="comment">#python读取csv数据（添加列名，指定分隔方式）</span></span><br><span class="line"><span class="comment">#现有CSV/EXCEL文件一个，为简化期间，为一个3x3的数据文件，内容如下：</span></span><br><span class="line"><span class="comment">#1,2,3</span></span><br><span class="line"><span class="comment">#2,1,3</span></span><br><span class="line"><span class="comment">#3,2,1</span></span><br><span class="line"><span class="comment">#用pandas.read读取以后，第一行自动被识别为columns，造成数据出错</span></span><br><span class="line"><span class="comment">#   1 2 3</span></span><br><span class="line"><span class="comment">#0 2 1 3</span></span><br><span class="line"><span class="comment">#1 3 2 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#有没有什么命令可以添加自定义的columns的名字，比如我想命名为 A, B, C三列，该怎么操作呢？</span></span><br><span class="line"><span class="comment">#pd.read_csv(file, header=None, names = [‘a‘,‘b‘,‘c‘] )</span></span><br></pre></td></tr></table></figure>
<p><strong>24. 读取excel的所有sheet名</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_excel(<span class="string">"xxx.xlsx"</span>, <span class="literal">None</span>)</span><br><span class="line">df.keys()</span><br><span class="line"></span><br><span class="line">xl = pd.ExcelFile(<span class="string">'xxx.xlsx'</span>)</span><br><span class="line">xl.sheet_names  <span class="comment"># see all sheet names</span></span><br></pre></td></tr></table></figure>
<p><strong>25. 读取多个sheet合并到一个文件夹</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"></span><br><span class="line">list1=glob.glob(<span class="string">'*.xlsx'</span>)</span><br><span class="line"></span><br><span class="line">writer=pd.ExcelWriter(<span class="string">'111.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list1:</span><br><span class="line">    keshi=i.split(<span class="string">'--'</span>)[<span class="number">-1</span>].split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">    a=pd.read_excel(i)</span><br><span class="line">    data=a[a[<span class="string">'科室'</span>].str.contains(keshi)]</span><br><span class="line">    data.to_excel(writer,keshi,index=<span class="number">0</span>)</span><br><span class="line">writer.save()</span><br><span class="line"></span><br><span class="line">data=pd.ExcelFile(<span class="string">'111.xlsx'</span>)</span><br><span class="line"></span><br><span class="line">sheet_names=data.sheet_names</span><br><span class="line"></span><br><span class="line">data=pd.read_excel(<span class="string">'111.xlsx'</span>,sheet_names[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> sheet_names[<span class="number">1</span>:]:</span><br><span class="line">    data1=pd.read_excel(<span class="string">'111.xlsx'</span>,sheet)</span><br><span class="line">    data=pd.concat([data,data1])</span><br><span class="line">    </span><br><span class="line">data.to_excel(<span class="string">'333.xlsx'</span>,index=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><strong>26. 将目录下所有excel的所有sheet读取并合到一张表</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将excel中的sheet名称放入列表</span></span><br><span class="line">sheet_names = sheet_list</span><br><span class="line"><span class="comment"># 将excel文件名称放入列表</span></span><br><span class="line">xlsx_names = [x <span class="keyword">for</span> x <span class="keyword">in</span> os.listdir() <span class="keyword">if</span> x.endswith(<span class="string">".xlsx"</span>)]</span><br><span class="line"></span><br><span class="line">writer = pd.ExcelWriter(<span class="string">'result.xlsx'</span>,engine=<span class="string">'openpyxl'</span>)</span><br><span class="line"></span><br><span class="line">num = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> sheet_name <span class="keyword">in</span> sheet_names:</span><br><span class="line">    df = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> xlsx_name <span class="keyword">in</span> xlsx_names:</span><br><span class="line">        _df = pd.read_excel(<span class="string">'119.xlsx'</span>, sheet_name=sheet_name)</span><br><span class="line">        <span class="keyword">if</span> df <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            df = _df</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            df = pd.concat([df, _df], ignore_index=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 下面的保存文件处填写writer，结果会不断地新增sheet，避免循环时被覆盖</span></span><br><span class="line">    df.to_excel(excel_writer=writer, sheet_name=sheet_name, encoding=<span class="string">"utf-8"</span>, index=<span class="literal">False</span>)</span><br><span class="line">    print(sheet_name + <span class="string">"  保存成功！共%d个，第%d个。"</span> % (len(sheet_names),num))</span><br><span class="line">    num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">writer.save()</span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>
<p><strong>0x02 其它功能性代码组合</strong></p>
<p><strong>1. 对某列的内容分列</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">employees = pd.read_excel(<span class="string">"../Employees.xlsx"</span>,index_col=<span class="string">"ID"</span>)</span><br><span class="line">employees .head()</span><br><span class="line"></span><br><span class="line">Employees.xlsx 文件样例：</span><br><span class="line"></span><br><span class="line">ID     Full Name</span><br><span class="line"><span class="number">1</span>     Syed Abbas</span><br><span class="line"><span class="number">2</span>     Catherine Abel</span><br><span class="line"><span class="number">3</span>     Kim Abercrombie</span><br><span class="line"></span><br><span class="line"><span class="number">1.1</span> 对 Full Name 进行切割分列</span><br><span class="line"></span><br><span class="line"><span class="comment"># df = employees["Full Name"].str.split()  # str.split()不写参数，会把分隔的内容放在一个列表里</span></span><br><span class="line"><span class="comment"># df</span></span><br><span class="line"></span><br><span class="line">df = employees[<span class="string">"Full Name"</span>].str.split(expand=<span class="literal">True</span>)  <span class="comment"># expand=True  可以把用分割的内容直接分列</span></span><br><span class="line">employees[<span class="string">"FirstName"</span>]=df[<span class="number">0</span>]</span><br><span class="line">employees[<span class="string">"LastName"</span>]=df[<span class="number">1</span>]</span><br><span class="line">print(employees)</span><br><span class="line"></span><br><span class="line"><span class="number">1.2</span> 把分隔后的FistName 都变成大写</span><br><span class="line"></span><br><span class="line">employees[<span class="string">"FirstName"</span>]=employees[<span class="string">"FirstName"</span>].str.upper()</span><br><span class="line">print(employees)</span><br><span class="line"></span><br><span class="line"><span class="number">1.3</span> 把分隔的LastName都变成小写 </span><br><span class="line"></span><br><span class="line">employees[<span class="string">"LastName"</span>]=employees[<span class="string">"LastName"</span>].str.lower()</span><br><span class="line">print(employees)</span><br></pre></td></tr></table></figure>
<p><strong>2. 设置单元格条件格式1—指定值字体变色、指定值设置背景色</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">AuditData = pd.read_excel(../单点登录记录.xlsx)</span><br><span class="line"></span><br><span class="line"><span class="number">2.1</span> 用<span class="function"><span class="keyword">def</span>函数对数值低于60的标记红色字体</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">low_score_red</span><span class="params">(s)</span>:</span> <span class="comment"># s 表示每个数值</span></span><br><span class="line">    color = <span class="string">'red'</span> <span class="keyword">if</span> s&lt;<span class="number">60</span> <span class="keyword">else</span> <span class="string">'black'</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f"color:<span class="subst">&#123;color&#125;</span>"</span></span><br><span class="line"></span><br><span class="line">AuditData.style.applymap(low_score_red,subset=[<span class="string">'test1'</span>,<span class="string">'test2'</span>,<span class="string">'test3'</span>])</span><br><span class="line"></span><br><span class="line"><span class="number">2.2</span> 用<span class="function"><span class="keyword">def</span>函数对每个字段中最高数值标记背景色为绿色</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">highest_score_green</span><span class="params">(col)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'background-color:lime'</span> <span class="keyword">if</span> s == col.max() <span class="keyword">else</span> <span class="string">'background-color:white'</span> <span class="keyword">for</span> s <span class="keyword">in</span> col]</span><br><span class="line"></span><br><span class="line">AuditData.style.applymap(highest_score_green,subset=[<span class="string">'test1'</span>,<span class="string">'test2'</span>,<span class="string">'test3'</span>])</span><br><span class="line"></span><br><span class="line"><span class="number">2.3</span> 同时引用两个函数</span><br><span class="line"><span class="comment"># .applymap：对subset所有列的值一起操作</span></span><br><span class="line"><span class="comment"># .apply：对subset里的每一列的值操作</span></span><br><span class="line"></span><br><span class="line">AuditData.style.applymap(low_score_red,subset=[<span class="string">'test1'</span>,<span class="string">'test2'</span>,<span class="string">'test3'</span>])\</span><br><span class="line">.apply(highest_score_green,subset=[<span class="string">'test1'</span>,<span class="string">'test2'</span>,<span class="string">'test3'</span>])</span><br></pre></td></tr></table></figure>
<p><strong>3. 设置单元格条件格式2—迷你条形图、用颜色深浅表示值大小</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">AuditData = pd.read_excel(../单点登录记录.xlsx,index_col=<span class="string">"ID"</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">3.1</span> 对每一列的值设置迷你条形图来表示数值的大小</span><br><span class="line"><span class="comment"># .style.bar（颜色，作用的数值区）</span></span><br><span class="line"></span><br><span class="line">AuditData.style.bar(color=<span class="string">"skyblue"</span>,subset=[<span class="string">'test1'</span>,<span class="string">'test2'</span>,<span class="string">'test3'</span>])</span><br><span class="line"></span><br><span class="line"><span class="number">3.2</span> 用颜色深浅来表示数值的大小，值越大颜色越深</span><br><span class="line"><span class="comment"># 需要引入seaborn的调色板：light_palette</span></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># sns.light_palette:调色板，里面的参数分别是要填充的颜色</span></span><br><span class="line">color_map = sns.light_palette(<span class="string">'green'</span>,as_cmap=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># .background_gradient() 表示填充subset参数里所有值的背景色（按列去识别大小填充）</span></span><br><span class="line">AuditData.style.background_gradient(color_map,subset=[<span class="string">'test1'</span>,<span class="string">'test2'</span>,<span class="string">'test3'</span>])</span><br></pre></td></tr></table></figure>
<p><strong>4. 更改DataFrame的某些值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、更改DataFrame中的数据，原理是将这部分数据提取出来，重新赋值为新的数据。</span><br><span class="line"><span class="number">2</span>、需要注意的是，数据更改直接针对DataFrame原数据更改，操作无法撤销，如果做出更改，需要对更改条件做确认或对数据进行备份。</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df1 = pd.DataFrame([[<span class="string">'Snow'</span>,<span class="string">'M'</span>,<span class="number">22</span>],[<span class="string">'Tyrion'</span>,<span class="string">'M'</span>,<span class="number">32</span>],[<span class="string">'Sansa'</span>,<span class="string">'F'</span>,<span class="number">18</span>],[<span class="string">'Arya'</span>,<span class="string">'F'</span>,<span class="number">14</span>]], columns=[<span class="string">'name'</span>,<span class="string">'gender'</span>,<span class="string">'age'</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">"--------更换单个值----------"</span>)</span><br><span class="line"><span class="comment"># loc和iloc 可以更换单行、单列、多行、多列的值</span></span><br><span class="line">df1.loc[<span class="number">0</span>,<span class="string">'age'</span>]=<span class="number">25</span>      <span class="comment"># 思路：先用loc找到要更改的值，再用赋值（=）的方法实现更换值</span></span><br><span class="line">df1.iloc[<span class="number">0</span>,<span class="number">2</span>]=<span class="number">25</span>         <span class="comment"># iloc：用索引位置来查找</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># at 、iat只能更换单个值</span></span><br><span class="line">df1.at[<span class="number">0</span>,<span class="string">'age'</span>]=<span class="number">25</span>      <span class="comment"># iat 用来取某个单值,参数只能用数字索引</span></span><br><span class="line">df1.iat[<span class="number">0</span>,<span class="number">2</span>]=<span class="number">25</span>         <span class="comment"># at 用来取某个单值,参数只能用index和columns索引名称</span></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>
<p><strong>5. 插入新增列、行</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame([[<span class="string">'Snow'</span>,<span class="string">'M'</span>,<span class="number">22</span>],[<span class="string">'Tyrion'</span>,<span class="string">'M'</span>,<span class="number">32</span>],[<span class="string">'Sansa'</span>,<span class="string">'F'</span>,<span class="number">18</span>],[<span class="string">'Arya'</span>,<span class="string">'F'</span>,<span class="number">14</span>]], columns=[<span class="string">'name'</span>,<span class="string">'gender'</span>,<span class="string">'age'</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">"----------在最后新增一列---------------"</span>)</span><br><span class="line">print(<span class="string">"-------案例1----------"</span>)</span><br><span class="line"><span class="comment"># 在数据框最后加上score一列，元素值分别为：80，98，67，90</span></span><br><span class="line">df1[<span class="string">'score'</span>]=[<span class="number">80</span>,<span class="number">98</span>,<span class="number">67</span>,<span class="number">90</span>]   <span class="comment"># 增加列的元素个数要跟原数据列的个数一样</span></span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"-------案例2----------"</span>)</span><br><span class="line">print(<span class="string">"---------在指定位置新增列:用insert（）--------"</span>)</span><br><span class="line"><span class="comment"># 在gender后面加一列城市</span></span><br><span class="line"><span class="comment"># 在具体某个位置插入一列可以用insert的方法</span></span><br><span class="line"><span class="comment"># 语法格式：列表.insert(index, obj)</span></span><br><span class="line"><span class="comment"># index ---&gt;对象 obj 需要插入的索引位置。</span></span><br><span class="line"><span class="comment"># obj ---&gt; 要插入列表中的对象（列名）</span></span><br><span class="line"></span><br><span class="line">col_name=df1.columns.tolist()                   <span class="comment"># 将数据框的列名全部提取出来存放在列表里</span></span><br><span class="line">print(col_name)</span><br><span class="line"></span><br><span class="line">col_name.insert(<span class="number">2</span>,<span class="string">'city'</span>)                      <span class="comment"># 在列索引为2的位置插入一列,列名为:city，刚插入时不会有值，整列都是NaN</span></span><br><span class="line">df1=df1.reindex(columns=col_name)              <span class="comment"># DataFrame.reindex() 对原行/列索引重新构建索引值</span></span><br><span class="line"></span><br><span class="line">df1[<span class="string">'city'</span>]=[<span class="string">'北京'</span>,<span class="string">'山西'</span>,<span class="string">'湖北'</span>,<span class="string">'澳门'</span>]   <span class="comment"># 给city列赋值</span></span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"----------新增行---------------"</span>)</span><br><span class="line"><span class="comment"># 重要！！先创建一个DataFrame，用来增加进数据框的最后一行</span></span><br><span class="line">new=pd.DataFrame(&#123;<span class="string">'name'</span>:<span class="string">'lisa'</span>,</span><br><span class="line">                  <span class="string">'gender'</span>:<span class="string">'F'</span>,</span><br><span class="line">                  <span class="string">'city'</span>:<span class="string">'北京'</span>,</span><br><span class="line">                  <span class="string">'age'</span>:<span class="number">19</span>,</span><br><span class="line">                  <span class="string">'score'</span>:<span class="number">100</span>&#125;,</span><br><span class="line">                 index=[<span class="number">1</span>])   <span class="comment"># 自定义索引为：1 ，这里也可以不设置index</span></span><br><span class="line">print(new)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"-------在原数据框df1最后一行新增一行，用append方法------------"</span>)</span><br><span class="line">df1=df1.append(new,ignore_index=<span class="literal">True</span>)   <span class="comment"># ignore_index=True,表示不按原来的索引，从0开始自动递增</span></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>
<p><strong>6. Series、DataFrame数据的loc、iloc、ix 查询 / 读取</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">一、DataFrame的数据查询 / 提取</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、对单列、多列进行访问读取</span><br><span class="line"></span><br><span class="line">     -- 对单列数据的访问：DataFrame的单列数据为一个Series。根据DataFrame的定义可以知晓DataFrame 是一个带有标签的二维数组，每个标签相当每一列的列名；如：df.a df[<span class="string">'a'</span>]</span><br><span class="line"></span><br><span class="line">     --  对多列数据访问：访问DataFrame多列数据可以将多个列索引名称视为一个列表，df[[<span class="string">'a'</span>,<span class="string">'b'</span>]]</span><br><span class="line"></span><br><span class="line"> <span class="number">2</span>、对多行进行访问读取</span><br><span class="line"></span><br><span class="line"> （<span class="number">1</span>）如果只是需要访问DataFrame某几行数据的实现方式则采用数组的选取方式，使用“:”。</span><br><span class="line"></span><br><span class="line"> （<span class="number">2</span>）head和tail也可以得到多行数据，但是用这两种方法得到的数据都是从开始或者末尾获取的连续数据；默认参数为访问<span class="number">5</span>行，只要在方法后方的“()”中填入访问行数即可实现目标行数的查看。</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、查看访问DataFrame中的数据——loc,iloc方法介绍</span><br><span class="line"></span><br><span class="line">（<span class="number">1</span>）loc方法是针对DataFrame索引名称的切片方法，如果传入的不是索引名称，那么切片操作将无法执行；利用loc方法，能够实现所有单层索引切片操作。</span><br><span class="line"></span><br><span class="line">         loc方法使用方法：DataFrame.loc[ 行索引名称或条件 , 列索引名称 ]   <span class="comment"># 闭区间（含最后一个值）</span></span><br><span class="line"></span><br><span class="line">（<span class="number">2</span>）iloc和loc区别：是iloc接收的必须是行索引和列索引的位置。</span><br><span class="line"></span><br><span class="line">         iloc方法的使用方法：DataFrame.iloc[ 行索引位置 ,  列索引位置 ]   <span class="comment"># 开区间（不含最后一个值）</span></span><br><span class="line"></span><br><span class="line">（<span class="number">3</span>）注意点：</span><br><span class="line"></span><br><span class="line">         -- 使用loc方法和iloc实现多列切片，其原理的通俗解释就是将多列的列名或者位置作为一个列表或者数据传入。</span><br><span class="line"></span><br><span class="line">         --  使用loc，iloc方法可以取出DataFrame中的任意数据。</span><br><span class="line"></span><br><span class="line">         --  loc内部还可以传入表达式，结果会返回满足表达式的所有值。</span><br><span class="line"></span><br><span class="line">         - - loc更加灵活多变，代码的可读性更高，iloc的代码简洁，但可读性不高。具体在数据分析工作中使用哪一种方法，根据情况而定，大多数时候建议使用loc方法。</span><br><span class="line"></span><br><span class="line">         -- 在loc使用的时候内部传入的行索引名称如果为一个区间，则前后均为闭区间；iloc方法使用时内部传入的行索引位置或列索引位置为区间时，则为前闭后开区间。</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、查看访问DataFrame中的数据——切片方法之ix</span><br><span class="line"></span><br><span class="line">（<span class="number">1</span>）ix方法更像是loc和iloc两种切片方法的融合。ix方法在使用时既可以接收索引名称也可以接收索引位置。</span><br><span class="line"></span><br><span class="line">（<span class="number">2</span>）其使用方法：DataFrame.ix[ 行索引的名称或位置或者条件, 列索引名称或位置 ]</span><br><span class="line"></span><br><span class="line">（<span class="number">3</span>）控制ix方法需要注意以下几点：</span><br><span class="line"></span><br><span class="line">        Ø 使用ix方法时，当索引名称和位置存在部分重叠时，ix默认优先识别名称。</span><br><span class="line">        Ø 尽量使用列索引名称，而非列索引位置，主要用来保证代码可读性。</span><br><span class="line">        Ø 使用列索引位置时，需要注解，同样保证代码可读性。</span><br><span class="line">        Ø 除此之外ix方法还有一个缺点，就是在面对数据量巨大的任务的时候，其效率会低于loc和iloc方法，所以在日常的数据分析工作中建议使用loc和iloc方法来执行切片操作。</span><br></pre></td></tr></table></figure>
<p><strong>6.1 代码部分：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">print(<span class="string">"-------创建一维Series数据------------"</span>)</span><br><span class="line"><span class="comment"># 创建方式1：</span></span><br><span class="line"><span class="comment"># s1=pd.Series([90,86,70],index=['leo','kate','john'])</span></span><br><span class="line"><span class="comment"># print(s1)</span></span><br><span class="line"><span class="comment"># 创建方式2：</span></span><br><span class="line">dict=&#123;<span class="string">'leo'</span>:<span class="number">90</span>,<span class="string">'kate'</span>:<span class="number">86</span>,<span class="string">'john'</span>:<span class="number">70</span>&#125;</span><br><span class="line">s1=pd.Series(dict)</span><br><span class="line">print(s1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"-----绝对位置查找----"</span>)</span><br><span class="line">print(s1[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">"-----标签查找-----"</span>)</span><br><span class="line">print(s1[<span class="string">'kate'</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">"-----列表标签查找----"</span>)</span><br><span class="line">print(s1[[<span class="string">'john'</span>,<span class="string">'kate'</span>]])</span><br><span class="line"></span><br><span class="line">print(<span class="string">"----条件表达式查找----"</span>)</span><br><span class="line">print(s1[s1&gt;<span class="number">80</span>])</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">print(<span class="string">"=========创建一组DataFrame数据---使用date_range创建时间索引======="</span>)</span><br><span class="line"></span><br><span class="line">date=pd.date_range(<span class="string">'20100101'</span>,periods=<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">df=pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),</span><br><span class="line">                index=date,</span><br><span class="line">                columns=list(<span class="string">'abcd'</span>))</span><br><span class="line"></span><br><span class="line">print(df.head())</span><br><span class="line">print(df.index)    <span class="comment"># 打印数据框的索引</span></span><br><span class="line">print(df.values)   <span class="comment"># 打印数据框内的元素值</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"---------读取单列、多列-------"</span>)</span><br><span class="line">print(df.a)</span><br><span class="line">print(df[<span class="string">'a'</span>])</span><br><span class="line">print(df[[<span class="string">'a'</span>,<span class="string">'b'</span>]])     <span class="comment"># 读取多列</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"------读取多行-----------"</span>)</span><br><span class="line">print(df[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line">print(df.head(<span class="number">3</span>))   <span class="comment"># 打印前3行数据</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"------读取多行、多列-----------"</span>)</span><br><span class="line">print(df.loc[<span class="string">'2010-01-01'</span>:<span class="string">'2010-01-04'</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>]])   <span class="comment"># loc是闭区间，尾部包含</span></span><br><span class="line">print(df.iloc[:<span class="number">4</span>,[<span class="number">0</span>,<span class="number">1</span>]])                               <span class="comment"># iloc是开区间，尾部不包含</span></span><br><span class="line">print(df.ix[:<span class="number">4</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>]])                           <span class="comment"># ix 是开区间，尾部不包含</span></span><br><span class="line">print(df.loc[df.index&lt;<span class="string">'20100105'</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>]])      <span class="comment"># loc 第一个参数可以用条件提取</span></span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 创建DataFrame</span></span><br><span class="line">df = pd.DataFrame([[<span class="string">'Snow'</span>,<span class="string">'M'</span>,<span class="number">22</span>],[<span class="string">'Tyrion'</span>,<span class="string">'M'</span>,<span class="number">32</span>],[<span class="string">'Sansa'</span>,<span class="string">'F'</span>,<span class="number">18</span>],[<span class="string">'Arya'</span>,<span class="string">'F'</span>,<span class="number">14</span>]], </span><br><span class="line">                  columns=[<span class="string">'name'</span>,<span class="string">'gender'</span>,<span class="string">'age'</span>])</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">"----------提取多行、多列-----------"</span>)</span><br><span class="line">print(df[[<span class="string">'gender'</span>,<span class="string">'age'</span>]])</span><br><span class="line">print(df.loc[<span class="number">1</span>:<span class="number">3</span>,[<span class="string">'gender'</span>,<span class="string">'age'</span>]])   <span class="comment"># loc是闭区间，尾部包含</span></span><br><span class="line">print(df.iloc[<span class="number">1</span>:<span class="number">3</span>,[<span class="number">1</span>,<span class="number">2</span>]])              <span class="comment"># iloc是开区间，尾部不包含</span></span><br><span class="line">print(df.iloc[:,<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line"><span class="comment"># 读取第1行到第2行的数据</span></span><br><span class="line">print(df[<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line">print(df.iloc[<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取第1行和第3行，第0列到第2列,不包括第二列</span></span><br><span class="line">print(df.iloc[[<span class="number">1</span>,<span class="number">3</span>],<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取倒数第3行到倒数第1行的数据，iloc不包含最后一行</span></span><br><span class="line">print(df[<span class="number">-3</span>:<span class="number">-1</span>])</span><br><span class="line">print(df.iloc[<span class="number">-3</span>:<span class="number">-1</span>])</span><br></pre></td></tr></table></figure>
<p><strong>0x03 基础代码含义大全 ①</strong></p>
<p><strong>1. 创建空DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df=pd.DataFrame()</span><br></pre></td></tr></table></figure>
<p><strong>2. 判断DataFrame是否为空</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.empty</span><br></pre></td></tr></table></figure>
<p><strong>3. DataFrame去重</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop_duplicates()</span><br></pre></td></tr></table></figure>
<p><strong>4. 替换DataFrame中指定字符串</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.replace(&#123;<span class="string">"2003-05-10"</span>: <span class="string">"2008-08-08"</span>&#125;, regex=<span class="literal">True</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><strong>5. 填充DataFrame中Nan</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=[[<span class="number">101</span>,<span class="number">90</span>],[<span class="number">102</span>,<span class="number">99</span>],[<span class="number">103</span>,]]</span><br><span class="line">df=pd.DataFrame(data=data,columns=[<span class="string">'id'</span>,<span class="string">'score'</span>])</span><br><span class="line">df.fillna(<span class="string">"未知"</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><strong>6. 重塑DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=[[<span class="string">'101'</span>,<span class="number">90</span>,<span class="string">'2003-05-10'</span>],[<span class="string">'102'</span>,<span class="number">99</span>,<span class="string">'2003-05-12'</span>],[<span class="string">'103'</span>,<span class="number">105</span>,<span class="string">'2003-05-11'</span>]]</span><br><span class="line">df=pd.DataFrame(data=data,columns=[<span class="string">'id'</span>,<span class="string">'score'</span>,<span class="string">'dt'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#重塑 以dt作为index,id的值作为列名，去填充对应score的值</span></span><br><span class="line"><span class="keyword">print</span> df.pivot(index=<span class="string">'dt'</span>, columns=<span class="string">'id'</span>, values=<span class="string">'score'</span>).reset_index()</span><br></pre></td></tr></table></figure>
<p><strong>7. DataFrame每列数据类型</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dtypes</span><br></pre></td></tr></table></figure>
<p><strong>8. DataFrame行数列数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure>
<p><strong>9. DataFrame列名</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns.values</span><br></pre></td></tr></table></figure>
<p><strong>10. 修改列名</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;<span class="string">'id'</span>:<span class="string">'studentID'</span>, <span class="string">'score'</span>:<span class="string">'studentScore'</span>&#125;, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><strong>11. 删除列</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop([<span class="string">'id'</span>], axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p><strong>12. 增加列</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'id2'</span>]= pd.Series(range(df.shape[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>
<p><strong>13. 某列转换成int类型</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'id'</span>] = df[<span class="string">'id'</span>].astype(<span class="string">'int'</span>)</span><br><span class="line">或</span><br><span class="line">df[<span class="string">'id'</span>]=df[<span class="string">'id'</span>].map(<span class="keyword">lambda</span> x:int(x))</span><br></pre></td></tr></table></figure>
<p><strong>14. 选出某列转List</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">"id"</span>].values.tolist()</span><br></pre></td></tr></table></figure>
<p><strong>15. 对每列求和</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.loc[<span class="string">'合  计'</span>] = df.apply(<span class="keyword">lambda</span> x: x.sum())</span><br><span class="line">注意：需要注意map()与apply()的区别，map中的函数作用于Series中的每一个元素，而apply中的函数作用于DataFrame一列或一行。</span><br></pre></td></tr></table></figure>
<p><strong>16. 按多列排序</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sort_values([<span class="string">'colNameA'</span>,<span class="string">'colNameB'</span>], ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><strong>17. 某列最小值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int(df[[<span class="string">'score'</span>]].min())</span><br></pre></td></tr></table></figure>
<p><strong>18. Union ALL</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([df1,df2])</span><br></pre></td></tr></table></figure>
<p><strong>19. Left/Right/Inner/Outer Join</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=[[<span class="string">'101'</span>,<span class="number">90</span>,<span class="string">'2003-05-10'</span>],[<span class="string">'102'</span>,<span class="number">99</span>,<span class="string">'2003-05-10'</span>],[<span class="string">'103'</span>,<span class="number">105</span>,<span class="string">'2003-05-11'</span>]]</span><br><span class="line">df=pd.DataFrame(data=data,columns=[<span class="string">'id'</span>,<span class="string">'score'</span>,<span class="string">'dt'</span>])</span><br><span class="line"></span><br><span class="line">data2=[(<span class="string">'101'</span>,<span class="string">'1'</span>),(<span class="string">'102'</span>,<span class="string">'0'</span>)]</span><br><span class="line">df2=pd.DataFrame(data=data2,columns=[<span class="string">'id'</span>,<span class="string">'sex'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#left join</span></span><br><span class="line">left_join_df=df.merge(right=df2, how=<span class="string">"left"</span>, on=<span class="string">"id"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#right join</span></span><br><span class="line"><span class="comment"># right_join_df=df.merge(right=df2, how="right", on="id")</span></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">right_join_df=df.merge(right=df2, how=<span class="string">"right"</span>, left_on=<span class="string">"id"</span>,right_on=<span class="string">"id"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#inner join</span></span><br><span class="line">inner_join_df=df.merge(right=df2, how=<span class="string">"inner"</span>, left_on=<span class="string">"id"</span>,right_on=<span class="string">"id"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#outer join</span></span><br><span class="line">outer_join_df=df.merge(right=df2, how=<span class="string">"outer"</span>, on=<span class="string">"id"</span>)</span><br><span class="line"></span><br><span class="line">总结：left join类似于SQL的left join。如A left join B，产生A的完整集，B中没有匹配上的以nan代替。同理 right join、inner join、outer join。</span><br><span class="line">pandas中DataFrame中merge，默认是inner join。</span><br></pre></td></tr></table></figure>
<p><strong>20. 筛选数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这些操作类似于Sql中的where条件。</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=[[<span class="string">'101'</span>,<span class="number">90</span>,<span class="string">'2003-05-10'</span>],[<span class="string">'102'</span>,<span class="number">99</span>,<span class="string">'2003-05-10'</span>],[<span class="string">'103'</span>,<span class="number">105</span>,]]</span><br><span class="line">df=pd.DataFrame(data=data,columns=[<span class="string">'id'</span>,<span class="string">'score'</span>,<span class="string">'dt'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#且</span></span><br><span class="line"><span class="keyword">print</span> df[(df[<span class="string">'id'</span>].isin([<span class="string">'101'</span>,<span class="string">'102'</span>]) &amp; (df[<span class="string">'score'</span>]==<span class="number">90</span>))]</span><br><span class="line"><span class="comment">#取反</span></span><br><span class="line"><span class="keyword">print</span> df[~df[<span class="string">'id'</span>].isin([<span class="string">'101'</span>,<span class="string">'102'</span>])]</span><br><span class="line"><span class="comment">#不等式</span></span><br><span class="line"><span class="keyword">print</span> df[df[<span class="string">'score'</span>]&gt;=<span class="number">99</span>]</span><br><span class="line"><span class="comment">#过滤掉非空</span></span><br><span class="line"><span class="keyword">print</span> df[df[<span class="string">'dt'</span>].notnull()]</span><br></pre></td></tr></table></figure>
<p><strong>21. 分组排序聚合</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data=[</span><br><span class="line">    (<span class="number">1</span>,<span class="number">80</span>,<span class="number">90</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">    (<span class="number">2</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">1</span>,<span class="number">2</span>),</span><br><span class="line">    (<span class="number">3</span>,<span class="number">70</span>,<span class="number">90</span>,<span class="number">1</span>,<span class="number">3</span>),</span><br><span class="line">    (<span class="number">4</span>,<span class="number">90</span>,<span class="number">80</span>,<span class="number">1</span>,<span class="number">3</span>),</span><br><span class="line">    (<span class="number">5</span>,<span class="number">60</span>,<span class="number">90</span>,<span class="number">1</span>,<span class="number">3</span>),</span><br><span class="line">    (<span class="number">6</span>,<span class="number">50</span>,<span class="number">80</span>,<span class="number">2</span>,<span class="number">3</span>),</span><br><span class="line">    (<span class="number">7</span>,<span class="number">80</span>,<span class="number">90</span>,<span class="number">2</span>,<span class="number">3</span>),</span><br><span class="line">    (<span class="number">8</span>,<span class="number">70</span>,<span class="number">70</span>,<span class="number">2</span>,<span class="number">1</span>),</span><br><span class="line">    (<span class="number">9</span>,<span class="number">90</span>,<span class="number">90</span>,<span class="number">2</span>,<span class="number">1</span>),</span><br><span class="line">    (<span class="number">10</span>,<span class="number">80</span>,<span class="number">90</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">]</span><br><span class="line">df=pd.DataFrame(data=data,columns=[<span class="string">'id'</span>,<span class="string">'language'</span>,<span class="string">'math'</span>,<span class="string">'grade'</span>,<span class="string">'class'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#分组求和---按grade,class分组，对language,math分别求和</span></span><br><span class="line"><span class="keyword">print</span> df.groupby([<span class="string">'grade'</span>,<span class="string">'class'</span>])[<span class="string">'language'</span>,<span class="string">'math'</span>].sum().reset_index()</span><br><span class="line"></span><br><span class="line"><span class="comment">#分组排序求TopN----按grade,class分组,取每组math最大的topN</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> pd.concat([subGroup.sort_values([<span class="string">'math'</span>],ascending=<span class="literal">False</span>).head(<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">for</span> subGroupName,subGroup <span class="keyword">in</span> df.groupby([<span class="string">'grade'</span>,<span class="string">'class'</span>])])</span><br></pre></td></tr></table></figure>
<p><strong>22. List-Tuple转DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data=[(<span class="number">101</span>,<span class="number">90</span>),(<span class="number">102</span>,<span class="number">99</span>),(<span class="number">103</span>,<span class="number">99</span>)]</span><br><span class="line">df=pd.DataFrame(data=data,columns=[<span class="string">'id'</span>,<span class="string">'score'</span>])</span><br></pre></td></tr></table></figure>
<p><strong>23. List-List转DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data=[[<span class="number">101</span>,<span class="number">90</span>],[<span class="number">102</span>,<span class="number">99</span>],[<span class="number">103</span>,<span class="number">99</span>]]</span><br><span class="line">df=pd.DataFrame(data=data,columns=[<span class="string">'id'</span>,<span class="string">'score'</span>])</span><br></pre></td></tr></table></figure>
<p><strong>24. List-Dict转DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data=[&#123;<span class="string">'id'</span>:<span class="number">101</span>,<span class="string">'score'</span>:<span class="number">90</span>&#125;,&#123;<span class="string">'id'</span>:<span class="number">102</span>,<span class="string">'score'</span>:<span class="number">99</span>&#125;,&#123;<span class="string">'id'</span>:<span class="number">103</span>,<span class="string">'score'</span>:<span class="number">99</span>&#125;]</span><br><span class="line">df=pd.DataFrame(data=data)</span><br></pre></td></tr></table></figure>
<p><strong>25. excel转DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_excel(io=<span class="string">"excelPath.xlsx"</span>, sheetname=<span class="string">"sheetName"</span>)</span><br></pre></td></tr></table></figure>
<p><strong>26. Csv文件转DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#注：读取Tsv文件,将分割符换成\t即可。</span></span><br><span class="line">df=pd.read_csv(filePath,sep=<span class="string">','</span>,names=[<span class="string">'colNameA'</span>,<span class="string">'colNameB'</span>...])</span><br></pre></td></tr></table></figure>
<p><strong>27. Json文件转DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_json(filePath, lines=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><strong>28. DataFrame保存成Csv文件</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.to_csv(<span class="string">"csvResult.csv"</span>,index=<span class="literal">False</span>,header=<span class="literal">True</span>,sep=<span class="string">','</span>,encoding=<span class="string">'utf-8-sig'</span>)</span><br></pre></td></tr></table></figure>
<p><strong>29. DataFrame保存成Json文件</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.to_json(path_or_buf=<span class="string">"jsonData.json"</span>,orient=<span class="string">'records'</span>, lines=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><strong>30. Sql执行结果转DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df=pd.read_sql(sql=sql,con=conn)</span><br></pre></td></tr></table></figure>
<p><strong>0x04 基础代码含义大全 ②</strong></p>
<p><strong>1. 引用库和pandas结构缩写</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DataFrame 别名 df</span><br><span class="line">Series    别名 s</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<p><strong>2. 数据导入</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(filename)      <span class="comment"># 导入csv格式文件中的数据</span></span><br><span class="line">pd.read_table(filename)    <span class="comment"># 导入有分隔符的文本 (如TSV) 中的数据</span></span><br><span class="line">pd.read_excel(filename)    <span class="comment"># 导入Excel格式文件中的数据</span></span><br><span class="line">pd.read_sql(query, connection_object)      <span class="comment"># 导入SQL数据表/数据库中的数据</span></span><br><span class="line">pd.read_json(json_string)  <span class="comment"># 导入JSON格式的字符，URL地址或者文件中的数据</span></span><br><span class="line">pd.read_html(url)          <span class="comment"># 导入经过解析的URL地址中包含的数据框 (DataFrame) 数据</span></span><br><span class="line">pd.read_clipboard()        <span class="comment"># 导入系统粘贴板里面的数据</span></span><br><span class="line">pd.DataFrame(dict)         <span class="comment"># 导入Python字典 (dict) 里面的数据，其中key是数据框的表头，value是数据框的内容。</span></span><br></pre></td></tr></table></figure>
<p><strong>3. 数据导出</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">df.to_csv(filename)       <span class="comment"># 将数据框 (DataFrame)中的数据导入csv格式的文件中</span></span><br><span class="line">df.to_excel(filename)     <span class="comment"># 将数据框 (DataFrame)中的数据导入Excel格式的文件中</span></span><br><span class="line">df.to_sql(table_name,connection_object)      <span class="comment"># 将数据框 (DataFrame)中的数据导入SQL数据表/数据库中</span></span><br><span class="line">df.to_json(filename)      <span class="comment"># 将数据框 (DataFrame)中的数据导入JSON格式的文件中</span></span><br></pre></td></tr></table></figure>
<p><strong>4. 数据查看与验证</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df.head(n)      <span class="comment"># 查看前n行数据</span></span><br><span class="line">df.tail(n)      <span class="comment"># 查看后n行数据</span></span><br><span class="line">df.shape        <span class="comment"># 查看数据的行数与列数</span></span><br><span class="line">df.info()       <span class="comment"># 查看数据 (DataFrame) 的索引、数据类型及内存信息</span></span><br><span class="line">df.describe()   <span class="comment"># 对于数据类型为数值型的列，查询其描述性统计的内容</span></span><br><span class="line">df.apply(pd.Series.value_counts)      <span class="comment"># 查询数据 (Data Frame) 中每个列的不同数据值出现次数统计</span></span><br></pre></td></tr></table></figure>
<p><strong>5. 数据的选取</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df[[col1, col2]]      <span class="comment"># 以新的数据(DataFrame)的形式返回选取的列</span></span><br><span class="line">s.iloc[<span class="number">0</span>]             <span class="comment"># 按照位置选取</span></span><br><span class="line">s.loc[<span class="string">'index_one'</span>]    <span class="comment"># 按照索引选取</span></span><br><span class="line">df.iloc[<span class="number">0</span>,:]          <span class="comment"># 选取第一行</span></span><br><span class="line">df.iloc[<span class="number">0</span>,<span class="number">0</span>]          <span class="comment"># 选取第一行的第一个元素</span></span><br></pre></td></tr></table></figure>
<p><strong>6. 数据清洗</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">df.columns = [<span class="string">'a'</span>,<span class="string">'b'</span>]      <span class="comment"># 重命名数据框的列名称</span></span><br><span class="line">pd.isnull(df)               <span class="comment"># 检查数据中空值出现的情况，并返回一个由布尔值(True,Fale)组成的列</span></span><br><span class="line">pd.notnull(df)              <span class="comment"># 检查数据中非空值出现的情况，并返回一个由布尔值(True,False)组成的列</span></span><br><span class="line">df.dropna()                 <span class="comment"># 移除数据框 DataFrame 中包含空值的行</span></span><br><span class="line">df.dropna(axis=<span class="number">1</span>)           <span class="comment"># 移除数据框 DataFrame 中包含空值的列</span></span><br><span class="line">df.fillna(x)                <span class="comment"># 将数据框 DataFrame 中的所有空值替换为 x</span></span><br><span class="line">s.fillna(s.mean())          <span class="comment"># 将所有空值替换为平均值</span></span><br><span class="line">s.astype(float)             <span class="comment"># 将数组(Series)的格式转化为浮点数</span></span><br><span class="line">s.replace(<span class="number">1</span>,<span class="string">'one'</span>)          <span class="comment"># 将数组(Series)中的所有1替换为'one'</span></span><br><span class="line">s.replace([<span class="number">1</span>,<span class="number">3</span>],[<span class="string">'one'</span>,<span class="string">'three'</span>])               <span class="comment"># 将数组(Series)中所有的1替换为'one', 所有的3替换为'three'</span></span><br><span class="line">df.rename(columns=<span class="keyword">lambda</span> x: x + <span class="number">2</span>)             <span class="comment"># 将全体列重命名</span></span><br><span class="line">df.rename(columns=&#123;<span class="string">'old_name'</span>: <span class="string">'new_ name'</span>&#125;)   <span class="comment"># 将选择的列重命名</span></span><br><span class="line">df.set_index(<span class="string">'column_one'</span>)                     <span class="comment"># 改变索引</span></span><br><span class="line">df.rename(index = <span class="keyword">lambda</span> x: x+ <span class="number">1</span>)              <span class="comment"># 改变全体索引</span></span><br></pre></td></tr></table></figure>
<p><strong>7. 数据过滤、排序、分组</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 过滤</span></span><br><span class="line">df[df[col] &gt; <span class="number">1</span>]                      <span class="comment"># 选取数据框df中对应行的数值大于1的全部列</span></span><br><span class="line">df[(df[col] &gt; <span class="number">1</span>) &amp; (df[col] &lt; <span class="number">2</span>)]    <span class="comment"># 选取数据框df中对应行的数值大于1，并且小于2的全部列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序</span></span><br><span class="line">df.sort_values(col1)                 <span class="comment"># 按照数据框的列col1升序(ascending)的方式对数据框df做排序</span></span><br><span class="line">df.sort_values(col2,ascending=<span class="literal">False</span>) <span class="comment"># 按照数据框的列col2降序(descending)的方式对数据框df做排序</span></span><br><span class="line">df.sort_values([col1,col2],ascending=[<span class="literal">True</span>,<span class="literal">False</span>])     <span class="comment"># 按照数据框的列col1升序，col2降序的方式对数据框df做排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组</span></span><br><span class="line">df.groupby(col)                      <span class="comment"># 按照某列对数据框df做分组</span></span><br><span class="line">df.groupby([col1,col2])              <span class="comment"># 按照列col1和col2对数据框df做分组</span></span><br><span class="line">df.groupby(col1)[col2].mean()        <span class="comment"># 按照列col1对数据框df做分组处理后，返回对应的col2的平均值</span></span><br><span class="line">df.apply(np.mean)                    <span class="comment"># 对数据框df的每一列求平均值</span></span><br><span class="line">df.apply(np.max,axis=<span class="number">1</span>)              <span class="comment"># 对数据框df的每一行求最大值</span></span><br></pre></td></tr></table></figure>
<p><strong>8. 数据的连接、组合</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 组合</span></span><br><span class="line">df1.append(df2)                      <span class="comment"># 在数据框df1的末尾添加数据框df2，其中df1和df2的列数应该相等</span></span><br><span class="line">pd.concat([df1, df2],axis=<span class="number">1</span>)         <span class="comment"># 在数据框df1的列最后添加数据框df2,其中df1和df2的行数应该相等</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接</span></span><br><span class="line">df1.join(df2,on=col1,how=<span class="string">'inner'</span>,,lsuffix=<span class="string">'_l'</span>,rsuffix=<span class="string">'_r'</span>) <span class="comment"># 对数据框df1和df2做内连接，其中连接的列为col1,为左右连接数据列添加后缀</span></span><br></pre></td></tr></table></figure>
<p><strong>9. 数据统计</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df.mean()          <span class="comment"># df中每一列的平均值</span></span><br><span class="line">df.describe()      <span class="comment"># df每一列的描述性统计</span></span><br><span class="line">df.corr()          <span class="comment"># df中每一列与其他列的相关系数</span></span><br><span class="line">df.count()         <span class="comment"># df中每一列的非空值个数</span></span><br><span class="line">df.max()           <span class="comment"># df中每一列的最大值</span></span><br><span class="line">df.min()           <span class="comment"># df中每一列的最小值</span></span><br><span class="line">df.median()        <span class="comment"># df中每一列的中位数</span></span><br><span class="line">df.std()           <span class="comment"># df中每一列的标准差</span></span><br></pre></td></tr></table></figure>
<p><strong>0x05 结尾语</strong></p>
<p>以上是收集整理的，经常会用到的代码公式，还有可能会用到的一些代码函数。</p>

      
      
        

      
    </div>
    <footer class="article-footer">
      
        <a data-url="sh1yan.top/2020/05/22/Common-codes-of-pandas-in-security-audit/" data-id="ckk4q7fgr005h9sw18nr77p9u" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pandas/">pandas</a></li></ul>


    </footer>
  </div>
  
    

  
</article>



</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 id="widget-title-about" class="widget-title">About</h3>
    <div class="widget">

<!-- 优美的分割线 -->

    <div style="width:249px;height:190px;border:1px none ;text-align:center">
  <img src="//sh1yan.top/icon.png" alt="shiyan" style="width:190px;height:190px;display:inline-block;margin:0 auto">
  </div>
<br>


<p style="font-size:15px">ID：shiyan</p>
<p style="font-size:14px">个人简介：会开挖挖机的园工~</p>
<p style="font-size:14px">
<a href="mailto:506130869@qq.com">Email：506130869@qq.com</a><br>
<a href="https://github.com/shiyan-520">GitHub：https://github.com/shiyan-520</a>
</p>


<!-- 优美的分割线 -->

      
      
      <p></p>
      
      
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 id="widget-title-tagcloud" class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/ByPass-UAC/" style="font-size: 10px;">ByPass-UAC</a> <a href="/tags/CMS/" style="font-size: 13.33px;">CMS</a> <a href="/tags/COM组件劫持/" style="font-size: 10px;">COM组件劫持</a> <a href="/tags/Cobalt-Strike/" style="font-size: 10px;">Cobalt Strike</a> <a href="/tags/DLL劫持/" style="font-size: 10px;">DLL劫持</a> <a href="/tags/Excel/" style="font-size: 13.33px;">Excel</a> <a href="/tags/JavaWeb/" style="font-size: 20px;">JavaWeb</a> <a href="/tags/Kerberos认证/" style="font-size: 10px;">Kerberos认证</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/PHP/" style="font-size: 13.33px;">PHP</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/Python3/" style="font-size: 10px;">Python3</a> <a href="/tags/Rmi协议/" style="font-size: 10px;">Rmi协议</a> <a href="/tags/SMBMS/" style="font-size: 10px;">SMBMS</a> <a href="/tags/UAC/" style="font-size: 10px;">UAC</a> <a href="/tags/XXE/" style="font-size: 10px;">XXE</a> <a href="/tags/access-token/" style="font-size: 10px;">access token</a> <a href="/tags/burp/" style="font-size: 16.67px;">burp</a> <a href="/tags/hash/" style="font-size: 10px;">hash</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jsonp/" style="font-size: 10px;">jsonp</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/metasploit/" style="font-size: 10px;">metasploit</a> <a href="/tags/mysql/" style="font-size: 13.33px;">mysql</a> <a href="/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/spring5/" style="font-size: 10px;">spring5</a> <a href="/tags/sqlmap/" style="font-size: 10px;">sqlmap</a> <a href="/tags/vba/" style="font-size: 13.33px;">vba</a> <a href="/tags/web漏洞/" style="font-size: 13.33px;">web漏洞</a> <a href="/tags/令牌伪造/" style="font-size: 10px;">令牌伪造</a> <a href="/tags/动态代理/" style="font-size: 10px;">动态代理</a> <a href="/tags/博客源码/" style="font-size: 10px;">博客源码</a> <a href="/tags/博客问题解决/" style="font-size: 10px;">博客问题解决</a> <a href="/tags/反射/" style="font-size: 10px;">反射</a> <a href="/tags/域渗透/" style="font-size: 10px;">域渗透</a> <a href="/tags/学习笔记/" style="font-size: 13.33px;">学习笔记</a> <a href="/tags/安全审计/" style="font-size: 13.33px;">安全审计</a> <a href="/tags/安全服务/" style="font-size: 10px;">安全服务</a> <a href="/tags/工具分析/" style="font-size: 10px;">工具分析</a> <a href="/tags/序列化/" style="font-size: 10px;">序列化</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/漏洞复现/" style="font-size: 10px;">漏洞复现</a> <a href="/tags/生活记录/" style="font-size: 10px;">生活记录</a> <a href="/tags/端口转发/" style="font-size: 10px;">端口转发</a> <a href="/tags/脚本编写/" style="font-size: 10px;">脚本编写</a> <a href="/tags/部署上线/" style="font-size: 10px;">部署上线</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 id="widget-title-recent-posts" class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/02/Spring-5-learning-notes/">Spring5学习笔记</a>
          </li>
        
          <li>
            <a href="/2020/07/18/An-audit-of-Java-Web-smbms/">记一次对JavaWeb-SMBMS的审计</a>
          </li>
        
          <li>
            <a href="/2020/06/18/Java-RMI-protocol-learning/">Java Rmi协议学习</a>
          </li>
        
          <li>
            <a href="/2020/06/13/Java-Dynamic-agent-mode/">Java动态代理模式</a>
          </li>
        
          <li>
            <a href="/2020/06/07/Java-serialization-mechanism/">Java序列化机制探究</a>
          </li>
        
      </ul>
    </div>
  </div>


  
</aside>

        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
    不要因为走了太久而忘记当初为什么出发。
    <br>
    Copyrights &copy; 2021 shiyan All Rights Reserved. 
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_uv"> 
    <a>「</a>本站访客数<span id="busuanzi_value_site_uv"></span>人次<a>」</a>
    </span></div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/gossip" class="mobile-nav-link">Gossip</a>
  
    <a href="/yqlj" class="mobile-nav-link">Links</a>
  
</nav>

    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.4";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<script src="/js/script.js"></script>


  </div>
</body>
</html>
