<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>BurpSuite插件编写[初级篇] | sh1yan&#39;blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="description" content="0x00 前言 上一篇文章主要是介绍burp插件的基本情况，对插件编写有一个入门的了解，本篇将以调试分析的角度，记录一下学习方法和编写流程。 0x01 debug 前期文件准备 在编写插件代码的时候，若不进行一步步的调试的话，只能是凭空造轮子，耗时耗力。">
<meta name="keywords" content="burp">
<meta property="og:type" content="article">
<meta property="og:title" content="BurpSuite插件编写[初级篇]">
<meta property="og:url" content="sh1yan.top/2020/04/12/Writing-of-burpseuite-plug-in-preliminary/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="0x00 前言 上一篇文章主要是介绍burp插件的基本情况，对插件编写有一个入门的了解，本篇将以调试分析的角度，记录一下学习方法和编写流程。 0x01 debug 前期文件准备 在编写插件代码的时候，若不进行一步步的调试的话，只能是凭空造轮子，耗时耗力。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\2.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\3.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\4.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\5.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\6.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\7.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\8.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\9.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\10.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\11.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\12.jpg">
<meta property="og:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\13.png">
<meta property="og:updated_time" content="2020-04-11T18:19:47.957Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BurpSuite插件编写[初级篇]">
<meta name="twitter:description" content="0x00 前言 上一篇文章主要是介绍burp插件的基本情况，对插件编写有一个入门的了解，本篇将以调试分析的角度，记录一下学习方法和编写流程。 0x01 debug 前期文件准备 在编写插件代码的时候，若不进行一步步的调试的话，只能是凭空造轮子，耗时耗力。">
<meta name="twitter:image" content="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\2.jpg">
  
    <link rel="alternative" href="/atom.xml" title="sh1yan&#39;blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  

  

</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/gossip">Gossip</a>
        
          <a class="main-nav-link" href="/yqlj">Links</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="sh1yan.top"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Writing-of-burpseuite-plug-in-preliminary" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/04/12/Writing-of-burpseuite-plug-in-preliminary/" class="article-date">
  <time datetime="2020-04-11T18:00:55.000Z" itemprop="datePublished">2020-04-12</time>
</a>

    
  <div class="article-category">
    <a class="article-category-link" href="/categories/编程代码/">编程代码</a>
  </div>


  </div>
  <div class="article-inner">
    

    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      BurpSuite插件编写[初级篇]
    </h1>
  


      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <div class="article-sharing">
  <ul>
    <li>
      <div class="fb-like" data-send="false" data-layout="button_count" data-show-faces="false" data-font="verdana" data-href="sh1yan.top/2020/04/12/Writing-of-burpseuite-plug-in-preliminary/"></div>
    </li>
  </ul>
</div>

      
      
        
        <p><strong>0x00 前言</strong></p>
<p>上一篇文章主要是介绍burp插件的基本情况，对插件编写有一个入门的了解，本篇将以调试分析的角度，记录一下学习方法和编写流程。</p>
<p><strong>0x01 debug 前期文件准备</strong></p>
<p>在编写插件代码的时候，若不进行一步步的调试的话，只能是凭空造轮子，耗时耗力。<br><a id="more"></a><br>因为我们大部分测试者都是使用的破解版，所以在配置调试的时候因为某些原因是不太适用的，故需要下载一个社会版。这里我已经1.7.26版本，2.0的版本的文件太大了。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\2.jpg" alt="2"></p>
<p>下载地址：<a href="https://portswigger.net/burp/releases/professional-community-1-7-26" target="_blank" rel="noopener">https://portswigger.net/burp/releases/professional-community-1-7-26</a></p>
<p>网盘版地址：链接: <a href="https://pan.baidu.com/s/10rwx1eWdNCEQWqw4KpqtEw" target="_blank" rel="noopener">https://pan.baidu.com/s/10rwx1eWdNCEQWqw4KpqtEw</a> 提取码: xtnt</p>
<p>正因为我们使用的社区版，所以在挑选现成的burp插件的时候，需要避开那些要使用到专业版或者企业版的API的插件。</p>
<p>这里我以 <a href="https://github.com/PortSwigger/request-timer" target="_blank" rel="noopener">request-timer</a> 插架为dome开始进行分析，该插件的功能介绍如下：</p>
<blockquote>
<p>Burp Request Timer</p>
<p>此扩展捕获所有Burp工具发出的请求的响应时间。在发现潜在的定时攻击中可能很有用。</p>
<p>可以通过工具（代理，扫描仪，入侵者中继器），目标作用域以及与URL中的字符串进行匹配来过滤结果。</p>
<p>需要Java 8。</p>
</blockquote>
<p>选用该插件作为分析的原因还有一个就是，几个月前，看到 ch1st 写了一个插件，就是基于被动或者主动识别存在java各种反序列化特征的插件，而现在这个大体上都差不多。</p>
<p><strong>0x02 debug 操作流程</strong></p>
<p>下载好上面的那个插件源码后，因为github上没有直接附上成品和相应API接口文件，所以需要我们自己导入到相应文件中。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\3.jpg" alt="3"></p>
<p>整理好后，直接打包成jar文件即可。</p>
<p>1、首先我们使用以下命令打开burp社区版</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=<span class="number">8888</span> -jar burpsuite_free_v1.7.26.jar</span><br></pre></td></tr></table></figure>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\4.jpg" alt="4"></p>
<p>该命令启动的burp，是便于我们进行远程调试的，即开启了远程调试端口。</p>
<p>2、我们导入刚才编译好的jar插件。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\5.jpg" alt="5"></p>
<p>3、这个插件的页面是这个样子的。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\6.jpg" alt="6"></p>
<p>4、我们开始设置eclipse中的远程调试配置。</p>
<p>4.1、运行→调试配置</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\7.jpg" alt="7"></p>
<p>4.2、选择 远程Java应用程序→鼠标右键→新建</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\8.jpg" alt="8"></p>
<p>4.3、名称可以随便设置，主要需要设置好端口号和启动burp的端口号一致，剩下的点击应用和调试即可。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\9.jpg" alt="9"></p>
<p>4.3、选择IDE右上角的调试界面按钮，我们就能看到整个运行过程。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\10.jpg" alt="10"></p>
<p>4.4、我们先下个断点，看看效果吧。</p>
<p>4.5、我们在99、100、101这三行加了断点。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\11.jpg" alt="11"></p>
<p>4.6、在burp界面一顿操作啊操作（让插件进行相应功能），然后我们就可以看到调试界面显示的参数了。</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\12.jpg" alt="12"></p>
<p>我们可以看到 toolFlag 这个接受到的参数是 4，具体这个参数4是什么意思，需要去翻看API手册中即可。</p>
<p><strong>注：</strong>需要注意的是，编译的 jar 中的代码必须和我们进行调试的代码一模一样，这样在远程调试的时候，不会出错。</p>
<p><strong>0x03 Burp Request Timer 源码分析</strong></p>
<p>先写一个好的插件，就需要参考前辈们的代码，既减少了重复造轮子，也学习了前辈们编写的思路。</p>
<p>首先我们看一下这个源码函数的大致UML图：</p>
<p><img src="http:\\sh1yan.top\photo\Writing-of-burpseuite-plug-in-preliminary\13.png" alt></p>
<p>源码整体函数可以分为三个部分，分别是：</p>
<ul>
<li>插件主体逻辑部分：BurpExtender</li>
<li>UI界面代码部分：MainPanel</li>
<li>功能数据存放部分：LogTablemodel、LogTable、Log</li>
</ul>
<p>由于源码继承问题，我从下往上进行分析（功能数据存放部分→UI界面代码部分→插件主体逻辑部分）。</p>
<p><strong>0x04 功能数据存放部分 Log</strong></p>
<p><strong>源码示例：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> burp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 请求获取的相关数据对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Log</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> LocalDateTime timestamp;</span><br><span class="line">    <span class="keyword">final</span> String tool;</span><br><span class="line">    <span class="keyword">final</span> IHttpRequestResponsePersisted requestResponse;</span><br><span class="line">    <span class="keyword">final</span> URL url;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">long</span> time;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">short</span> status;</span><br><span class="line">    <span class="keyword">final</span> String mimeType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timestamp 请求时间戳</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tool tool来源</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> requestResponse HttpRequestResponse获得的对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url 请求连接</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status HTTP设置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mimeType 未知的MIME类型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time 时间taken</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Log(LocalDateTime timestamp, String tool, IHttpRequestResponsePersisted requestResponse, URL url, <span class="keyword">short</span> status, String mimeType, <span class="keyword">long</span> time) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.timestamp = timestamp;</span><br><span class="line">        <span class="keyword">this</span>.tool = tool;</span><br><span class="line">        <span class="keyword">this</span>.requestResponse = requestResponse;</span><br><span class="line">        <span class="keyword">this</span>.url = url;</span><br><span class="line">        <span class="keyword">this</span>.time = time;</span><br><span class="line">        <span class="keyword">this</span>.status = status;</span><br><span class="line">        <span class="keyword">this</span>.mimeType = mimeType;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>整体类函数功能：</strong></p>
<p>该代码部分主要是把相应字段信息以常量参数的形式进行储存,便于数据的调用和展示，而Log类主要被 LogTableModel类使用。</p>
<p><strong>0x05 功能数据存放部分 LogTableModel</strong></p>
<p><strong>源码示例：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> burp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;  <span class="comment">// 可调整大小的数组的实现List接口类库</span></span><br><span class="line"><span class="keyword">import</span> java.util.List;  <span class="comment">// 有序集合类库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.table.AbstractTableModel;  <span class="comment">// 此抽象类提供默认实现大部分的方法TableModel接口</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 存放日志表的对象类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogTableModel</span> <span class="keyword">extends</span> <span class="title">AbstractTableModel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> java.util.List&lt;Log&gt; logArray = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRowCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    	<span class="comment">/* 抽象类 AbstractTableModel 必须要重写的函数</span></span><br><span class="line"><span class="comment">    	 * 返回列表内元素个数</span></span><br><span class="line"><span class="comment">    	 */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> logArray.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getColumnCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    	<span class="comment">/* 抽象类 AbstractTableModel 必须要重写的函数</span></span><br><span class="line"><span class="comment">    	 * 返回列数，固定为6个字段</span></span><br><span class="line"><span class="comment">    	 */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getColumnName</span><span class="params">(<span class="keyword">int</span> columnIndex)</span> </span>&#123;</span><br><span class="line">    	<span class="comment">/* 非强制需重写的方法函数</span></span><br><span class="line"><span class="comment">    	 * 使用电子表格约定返回列的默认名称</span></span><br><span class="line"><span class="comment">    	 */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (columnIndex) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"Timestamp"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"Tool"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"Request URL"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"MIME Type"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"Response Time (ms)"</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"HTTP Status"</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getColumnClass(<span class="keyword">int</span> columnIndex) &#123;</span><br><span class="line">    	<span class="comment">/* 非强制需重写的方法函数</span></span><br><span class="line"><span class="comment">    	 * 返回当前列的对象类型</span></span><br><span class="line"><span class="comment">    	 */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (columnIndex) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> String.class;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> String.class;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> String.class;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">return</span> String.class;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                <span class="keyword">return</span> Long.class;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">return</span> Short.class;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> Object.class;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getValueAt</span><span class="params">(<span class="keyword">int</span> rowIndex, <span class="keyword">int</span> columnIndex)</span> </span>&#123;</span><br><span class="line">    	<span class="comment">/* 抽象类 AbstractTableModel 必须要重写的函数</span></span><br><span class="line"><span class="comment">    	 * 返回行列中选定的值</span></span><br><span class="line"><span class="comment">    	 */</span></span><br><span class="line"></span><br><span class="line">        Log logEntry = logArray.get(rowIndex);</span><br><span class="line">        <span class="comment">// 通过行值进行在 ArrayList 中选定最终的对象，然后使用下列switch语法选中值</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (columnIndex) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> logEntry.timestamp;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> logEntry.tool;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> logEntry.url.toString();</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">return</span> logEntry.mimeType;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                <span class="keyword">return</span> logEntry.time;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                <span class="keyword">return</span> logEntry.status;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the &lt;code&gt;Log&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &lt;code&gt;List&lt;Log&gt;&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Log&gt; <span class="title">getLogArray</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    	<span class="comment">/*</span></span><br><span class="line"><span class="comment">    	 * 返回所有数据的对象值列表</span></span><br><span class="line"><span class="comment">    	 */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> logArray;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>整体类函数功能：</strong></p>
<p>该类的构造函数是生成了一个 ArrayList() 的列表，而列表的类型为 Log，然后分别创建或重新了以下几个函数：</p>
<ol>
<li>getRowCount()：获取列表内元素的个数，该函数是抽象类 AbstractTableModel 强制要重写的函数。</li>
<li>getColumnCount()：返回字段的列数，由于我们前期就设置了6个固定字段（Timestamp、Tool、Request URL、MIME Type、Response Time (ms)、HTTP Status），该字段值数是与UI页面显示字段数相一致的，该函数是抽象类 AbstractTableModel 强制要重写的函数。。</li>
<li>getColumnName(int columnIndex)：该函数主要是根据固定值返回对应字段的名称。</li>
<li>getColumnClass(int columnIndex)：该函数主要是根据固定值返回对应字段的对象类型。</li>
<li>getValueAt(int rowIndex, int columnIndex)：该函数主要是根据固定的值返回对应字段下的数据内容。</li>
<li>getLogArray()：返回当前类的List对象。</li>
</ol>
<p><strong>0x06 功能数据存放部分 LogTable</strong></p>
<p><strong>源码示例：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> burp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.JTable; <span class="comment">// 用于显示和编辑单元格的常规二维表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 显示数据的类，该类继承了Burp的消息编辑器控制器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogTable</span> <span class="keyword">extends</span> <span class="title">JTable</span> <span class="keyword">implements</span> <span class="title">IMessageEditorController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LogTableModel logTableModel; <span class="comment">// 存放数据的类</span></span><br><span class="line">    <span class="keyword">private</span> IMessageEditor requestViewer; <span class="comment">// 请求消息显示</span></span><br><span class="line">    <span class="keyword">private</span> IMessageEditor responseViewer; <span class="comment">// 返回信息显示</span></span><br><span class="line">    <span class="keyword">private</span> IHttpRequestResponse currentlyDisplayedItem; <span class="comment">// 获取或更新HTTP相关数据流</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数，该类的只能接受该设置的参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> logTableModel &lt;code&gt;LogTableModel&lt;/code&gt; object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    LogTable(LogTableModel logTableModel) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">super</span>(logTableModel); <span class="comment">// JTable(TableModel dm) 获取需要显示的数据模型</span></span><br><span class="line">        <span class="keyword">this</span>.logTableModel = logTableModel;</span><br><span class="line">        <span class="keyword">this</span>.requestViewer = BurpExtender.callbacks.createMessageEditor(<span class="keyword">this</span>, <span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">this</span>.responseViewer = BurpExtender.callbacks.createMessageEditor(<span class="keyword">this</span>, <span class="keyword">false</span>);</span><br><span class="line">        setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);</span><br><span class="line">        <span class="comment">// 当表被调整大小时，设置表的自动调整大小模式;在所有调整大小操作期间，按比例调整所有列的大小</span></span><br><span class="line">        getColumnModel().getColumn(<span class="number">0</span>).setMinWidth(<span class="number">200</span>);</span><br><span class="line">        getColumnModel().getColumn(<span class="number">1</span>).setMinWidth(<span class="number">100</span>);</span><br><span class="line">        getColumnModel().getColumn(<span class="number">2</span>).setPreferredWidth(<span class="number">1000</span>);</span><br><span class="line">        getColumnModel().getColumn(<span class="number">3</span>).setMinWidth(<span class="number">100</span>);</span><br><span class="line">        getColumnModel().getColumn(<span class="number">4</span>).setMinWidth(<span class="number">150</span>);</span><br><span class="line">        getColumnModel().getColumn(<span class="number">5</span>).setMinWidth(<span class="number">100</span>);</span><br><span class="line">        setAutoCreateRowSorter(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 当调用setAutoCreateRowSorter(true)时，将TableRowSorter创建一个TableRowSorter并安装在表上。</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getRequest() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> currentlyDisplayedItem.getRequest();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] getResponse() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> currentlyDisplayedItem.getResponse();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IHttpService <span class="title">getHttpService</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> currentlyDisplayedItem.getHttpService();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changeSelection</span><span class="params">(<span class="keyword">int</span> row, <span class="keyword">int</span> col, <span class="keyword">boolean</span> toggle, <span class="keyword">boolean</span> extend)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 对选择的UI项进行调整大小长宽</span></span><br><span class="line">    	</span><br><span class="line">        Log logEntry = logTableModel.getLogArray().get(convertRowIndexToModel(row));</span><br><span class="line">        <span class="comment">// convertRowIndexToModel（row）将视图的行的索引映射到底层 TableModel 。</span></span><br><span class="line">        </span><br><span class="line">        requestViewer.setMessage(logEntry.requestResponse.getRequest(), <span class="keyword">true</span>);</span><br><span class="line">        responseViewer.setMessage(logEntry.requestResponse.getResponse(), <span class="keyword">false</span>);</span><br><span class="line">        currentlyDisplayedItem = logEntry.requestResponse;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">super</span>.changeSelection(row, col, toggle, extend);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回请求的HTTP的视图对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &lt;code&gt;IMessageEditor&lt;/code&gt; object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">IMessageEditor <span class="title">getRequestViewer</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> requestViewer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *返回相应的HTTP的视图对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &lt;code&gt;IMessageEditor&lt;/code&gt; object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">IMessageEditor <span class="title">getResponseViewer</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> responseViewer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>整体类函数功能：</strong></p>
<p>该类函数主要功能可以分为两个部分，一个部分为自适应调整UI界面的字段位置，另一个就是展示HTTP数据的请求和相应的具体数据，而该部分的作用主要是便于在UI界面代码部分进行直接调用显示。</p>
<p><strong>0x07 UI界面代码部分 MainPanel</strong></p>
<p><strong>源码示例：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> burp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.Color;  <span class="comment">// 颜色设置库</span></span><br><span class="line"><span class="keyword">import</span> java.awt.Component; <span class="comment">// 组件功能库</span></span><br><span class="line"><span class="keyword">import</span> java.awt.FlowLayout; <span class="comment">// 流程布局库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.BorderFactory;  <span class="comment">// 界面边界库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.BoxLayout;  <span class="comment">// 布局管理器库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JButton;  <span class="comment">// 按钮库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JCheckBox;  <span class="comment">// 复选框</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JComboBox;  <span class="comment">// 组合按钮或可编辑字段和下拉列表的组件库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JLabel;  <span class="comment">// 文本显示区域库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JPanel;  <span class="comment">// 面板库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JScrollPane;  <span class="comment">// 提供轻量级组件的可滚动视图库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JSplitPane;  <span class="comment">// 界面分列库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JTabbedPane;  <span class="comment">// 通过点击具有给定标题和/或图标的选项卡，用户可以在一组组件之间切换的组件库</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JTextField;  <span class="comment">// 编辑单行文本库</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 主显示界面类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainPanel</span> <span class="keyword">extends</span> <span class="title">JPanel</span> <span class="keyword">implements</span> <span class="title">ITab</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 继承了面板库，同时继承了Burp接口，该接口可以设置UI界面在Burp的UI上显示</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LogTableModel logTableModel;   <span class="comment">// 存放日志表的对象类 &#123; 可以用来查找相应数据的值&#125;</span></span><br><span class="line">    <span class="keyword">private</span> JTextField urlFilterText;  <span class="comment">// 当前手动文本输入参数</span></span><br><span class="line">    <span class="keyword">private</span> JCheckBox scopeCheckBox;  <span class="comment">// 选择栏参数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造函数，输入参数必须符合该构造函数要求</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> extender &lt;code&gt;BurpExtender&lt;/code&gt; object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    MainPanel(BurpExtender extender) &#123;</span><br><span class="line"></span><br><span class="line">        setLayout(<span class="keyword">new</span> BoxLayout(<span class="keyword">this</span>, BoxLayout.Y_AXIS));</span><br><span class="line">        <span class="comment">// 指定组件应该从上到下布置(设置布局管理)</span></span><br><span class="line"></span><br><span class="line">        JSplitPane splitPane = <span class="keyword">new</span> JSplitPane(JSplitPane.VERTICAL_SPLIT);</span><br><span class="line">        <span class="comment">// 垂直分割表示Component沿y轴分割。 例如，两个Component将被分割成一个在另一个之上。</span></span><br><span class="line"></span><br><span class="line">        logTableModel = <span class="keyword">new</span> LogTableModel(); <span class="comment">// 日志表存放类</span></span><br><span class="line">        LogTable logTable = <span class="keyword">new</span> LogTable(logTableModel); <span class="comment">// 显示数据的类</span></span><br><span class="line">        JScrollPane scrollPane = <span class="keyword">new</span> JScrollPane(logTable);  <span class="comment">// 日志数据的显示选择视图组件</span></span><br><span class="line">        splitPane.setLeftComponent(scrollPane);  <span class="comment">// 将组件设置在左边（或更高）分隔线</span></span><br><span class="line"></span><br><span class="line">        JTabbedPane tabs = <span class="keyword">new</span> JTabbedPane();</span><br><span class="line">        <span class="comment">// 带有请求/响应查看器的选项卡</span></span><br><span class="line">        </span><br><span class="line">        tabs.setBorder(BorderFactory.createLineBorder(Color.black));</span><br><span class="line">        tabs.addTab(<span class="string">"Request"</span>, logTable.getRequestViewer().getComponent());</span><br><span class="line">        tabs.addTab(<span class="string">"Response"</span>, logTable.getResponseViewer().getComponent());</span><br><span class="line">        splitPane.setRightComponent(tabs);</span><br><span class="line"></span><br><span class="line">        JPanel controlPanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> FlowLayout(FlowLayout.LEFT)); <span class="comment">// 顶部控制面板</span></span><br><span class="line"></span><br><span class="line">        JLabel toolLabel = <span class="keyword">new</span> JLabel(<span class="string">"Select tool: "</span>);</span><br><span class="line">        controlPanel.add(toolLabel);</span><br><span class="line"></span><br><span class="line">        String[] tools = &#123;<span class="string">"All"</span>, <span class="string">"Proxy"</span>, <span class="string">"Intruder"</span>, <span class="string">"Scanner"</span>, <span class="string">"Repeater"</span>&#125;;</span><br><span class="line">        JComboBox&lt;String&gt; toolList = <span class="keyword">new</span> JComboBox&lt;&gt;(tools);</span><br><span class="line">        toolList.addActionListener(e -&gt; &#123;</span><br><span class="line">            String tool = (String) ((JComboBox) e.getSource()).getSelectedItem();</span><br><span class="line">            <span class="keyword">if</span> (tool != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">switch</span> (tool) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">"All"</span>:</span><br><span class="line">                        extender.setToolFilter(<span class="number">0</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">"Proxy"</span>:</span><br><span class="line">                        extender.setToolFilter(IBurpExtenderCallbacks.TOOL_PROXY);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">"Intruder"</span>:</span><br><span class="line">                        extender.setToolFilter(IBurpExtenderCallbacks.TOOL_INTRUDER);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">"Scanner"</span>:</span><br><span class="line">                        extender.setToolFilter(IBurpExtenderCallbacks.TOOL_SCANNER);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">"Repeater"</span>:</span><br><span class="line">                        extender.setToolFilter(IBurpExtenderCallbacks.TOOL_REPEATER);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Unknown tool: "</span> + tool);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        controlPanel.add(toolList);</span><br><span class="line"></span><br><span class="line">        JButton startButton = <span class="keyword">new</span> JButton(<span class="string">"Start"</span>);</span><br><span class="line">        controlPanel.add(startButton);</span><br><span class="line">        JButton stopButton = <span class="keyword">new</span> JButton(<span class="string">"Stop"</span>);</span><br><span class="line">        controlPanel.add(stopButton);</span><br><span class="line">        JButton clearButton = <span class="keyword">new</span> JButton(<span class="string">"Clear"</span>);</span><br><span class="line">        stopButton.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">        controlPanel.add(clearButton);</span><br><span class="line">        JLabel scopeLabel = <span class="keyword">new</span> JLabel(<span class="string">"In-scope items only?"</span>);</span><br><span class="line">        controlPanel.add(scopeLabel);</span><br><span class="line">        scopeCheckBox = <span class="keyword">new</span> JCheckBox();</span><br><span class="line">        controlPanel.add(scopeCheckBox);</span><br><span class="line">        JLabel filterLabel = <span class="keyword">new</span> JLabel(<span class="string">"Filter URL:"</span>);</span><br><span class="line">        controlPanel.add(filterLabel);</span><br><span class="line">        urlFilterText = <span class="keyword">new</span> JTextField(<span class="number">40</span>);</span><br><span class="line">        controlPanel.add(urlFilterText);</span><br><span class="line"></span><br><span class="line">        startButton.addActionListener(e -&gt; &#123;</span><br><span class="line">            extender.setRunning(<span class="keyword">true</span>);</span><br><span class="line">            startButton.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            stopButton.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        stopButton.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">        stopButton.addActionListener(e -&gt; &#123;</span><br><span class="line">            extender.setRunning(<span class="keyword">false</span>);</span><br><span class="line">            startButton.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">            stopButton.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        clearButton.addActionListener(e -&gt; &#123;</span><br><span class="line">            extender.getReqResMap().clear();</span><br><span class="line">            logTableModel.getLogArray().clear();</span><br><span class="line">            logTableModel.fireTableDataChanged();</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        controlPanel.setAlignmentX(<span class="number">0</span>);</span><br><span class="line">        add(controlPanel);</span><br><span class="line">        add(splitPane);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// customize our UI components</span></span><br><span class="line">        BurpExtender.callbacks.customizeUiComponent(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTabCaption</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Request Timer"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Component <span class="title">getUiComponent</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the Log table model</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &lt;code&gt;LogTableModel&lt;/code&gt; object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">LogTableModel <span class="title">getLogTableModel</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> logTableModel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the text to filter the URL by</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> filter text</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">getURLFilterText</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> urlFilterText.getText();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Is the in scope only checkbox selected?</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true if selected, false if not</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isScopeSelected</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> scopeCheckBox.isSelected();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>整体类函数功能：</strong></p>
<p>该部分代码不解读，我感觉应该是使用了类似WindowBuilder的工具进行设置的UI界面，部分代码意思可以详见以上代码注释部分。</p>
<p><strong>0x08 插件主体逻辑部分 BurpExtender</strong></p>
<p><strong>源码示例：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> burp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;  <span class="comment">// burp提示信息库</span></span><br><span class="line"><span class="keyword">import</span> java.net.URL;  <span class="comment">// 处理URL连接库</span></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;  <span class="comment">// 获取指定时间库</span></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;  <span class="comment">// 字典形式数据储存库</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Main class</span></span><br><span class="line"><span class="comment"> * 插件主类，运行入口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BurpExtender</span> <span class="keyword">implements</span> <span class="title">IBurpExtender</span>, <span class="title">IHttpListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> IBurpExtenderCallbacks callbacks;  <span class="comment">// 回调参数</span></span><br><span class="line">    <span class="keyword">private</span> IExtensionHelpers helpers;   <span class="comment">// 辅助参数</span></span><br><span class="line">    <span class="keyword">private</span> MainPanel panel;  <span class="comment">// 插件面板类</span></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;URL, Long&gt; reqResMap = <span class="keyword">new</span> HashMap&lt;&gt;();   <span class="comment">// 提前指定存在数据的字典形式参数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isRunning = <span class="keyword">false</span>;   <span class="comment">// 判断是否运行中参数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> toolFilter = <span class="number">0</span>;   <span class="comment">// burp自带的参数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Burp插件主回调函数，也是继承IBurpExtendre接口必须实现的函数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerExtenderCallbacks</span><span class="params">(<span class="keyword">final</span> IBurpExtenderCallbacks callbacks)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        BurpExtender.callbacks = callbacks;  <span class="comment">// 把接口的参数传递给类本身参数</span></span><br><span class="line">        helpers = callbacks.getHelpers();  <span class="comment">// 获取扩展辅助对象并传递给提前设置的参数</span></span><br><span class="line">        callbacks.setExtensionName(<span class="string">"Request Timer"</span>);  <span class="comment">// 设置插架显示名称</span></span><br><span class="line">        panel = <span class="keyword">new</span> MainPanel(<span class="keyword">this</span>);  <span class="comment">// 实例化同Burp包下面的界面显示类</span></span><br><span class="line">        callbacks.addSuiteTab(panel); <span class="comment">// 添置插件的UI界面到Burp上</span></span><br><span class="line">        callbacks.registerHttpListener(<span class="keyword">this</span>); <span class="comment">// 注册监听模块</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置运行状态</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> running true or false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setRunning</span><span class="params">(<span class="keyword">boolean</span> running)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.isRunning = running;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置数据来源</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> toolFilter int representing the tool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setToolFilter</span><span class="params">(<span class="keyword">int</span> toolFilter)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.toolFilter = toolFilter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Process the HTTP message</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> toolFlag  originating tool</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> messageIsRequest true if request, false if response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> messageInfo &lt;code&gt;IHttpRequestResponse&lt;/code&gt; object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processHttpMessage</span><span class="params">(<span class="keyword">int</span> toolFlag, <span class="keyword">boolean</span> messageIsRequest, IHttpRequestResponse messageInfo)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isRunning) &#123;</span><br><span class="line">            <span class="keyword">if</span> (toolFilter == <span class="number">0</span> || toolFilter == toolFlag) &#123;</span><br><span class="line">                URL url = helpers.analyzeRequest(messageInfo).getUrl(); <span class="comment">// 分析HTTP请求，获得URL</span></span><br><span class="line">                <span class="keyword">if</span> (messageIsRequest) &#123; <span class="comment">// 判断当前是否调用或请求该方法</span></span><br><span class="line">                    reqResMap.put(url, System.currentTimeMillis()); <span class="comment">// 保存当前url和对应的发现时间</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (reqResMap.containsKey(url)) &#123; <span class="comment">// 判断当前是否已储存该URL对应关系</span></span><br><span class="line">                        <span class="keyword">long</span> time = System.currentTimeMillis() - reqResMap.get(url); <span class="comment">//计算获取响应的时间</span></span><br><span class="line">                        reqResMap.remove(url); <span class="comment">// 删除原指定关系</span></span><br><span class="line">                        <span class="keyword">synchronized</span> (panel.getLogTableModel().getLogArray()) &#123; <span class="comment">// 获取当前所有存放的URL信息数据；加上线程锁</span></span><br><span class="line">                            <span class="keyword">int</span> row = panel.getLogTableModel().getLogArray().size(); <span class="comment">// 获取字典信息总的个数</span></span><br><span class="line">                            <span class="keyword">if</span> (panel.getURLFilterText().isEmpty() &amp;&amp; !panel.isScopeSelected()) &#123;</span><br><span class="line">                                addLog(messageInfo, toolFlag, time, row); <span class="comment">// 如果相关信息没有被记录，则进行记录信息</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="comment">// 判断是否开启日志筛选器</span></span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">if</span> (!panel.isScopeSelected() &amp;&amp; !panel.getURLFilterText().isEmpty() &amp;&amp;</span><br><span class="line">                                    helpers.analyzeRequest(messageInfo).getUrl().toExternalForm().contains(panel.getURLFilterText())) &#123;</span><br><span class="line">                                addLog(messageInfo, toolFlag, time, row);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="comment">// Log in-scope requests</span></span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">if</span> (panel.isScopeSelected() &amp;&amp; panel.getURLFilterText().isEmpty() &amp;&amp;</span><br><span class="line">                                    callbacks.isInScope(helpers.analyzeRequest(messageInfo).getUrl())) &#123;</span><br><span class="line">                                addLog(messageInfo, toolFlag, time, row);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="comment">// Log in-scope requests and filter</span></span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">if</span> (panel.isScopeSelected() &amp;&amp; !panel.getURLFilterText().isEmpty() &amp;&amp;</span><br><span class="line">                                    callbacks.isInScope(helpers.analyzeRequest(messageInfo).getUrl()) &amp;&amp;</span><br><span class="line">                                    helpers.analyzeRequest(messageInfo).getUrl().toExternalForm().contains(panel.getURLFilterText())) &#123;</span><br><span class="line">                                addLog(messageInfo, toolFlag, time, row);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Helper to add a log entry</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> messageInfo &lt;code&gt;IHttpRequestResponse&lt;/code&gt; object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> toolFlag tool</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time time taken in ms</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> row row to insert at</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addLog</span><span class="params">(IHttpRequestResponse messageInfo, <span class="keyword">int</span> toolFlag, <span class="keyword">long</span> time, <span class="keyword">int</span> row)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        panel.getLogTableModel().getLogArray().add(<span class="keyword">new</span> Log(LocalDateTime.now(),</span><br><span class="line">                                                           callbacks.getToolName(toolFlag),</span><br><span class="line">                                                           callbacks.saveBuffersToTempFiles(messageInfo),</span><br><span class="line">                                                           helpers.analyzeRequest(messageInfo).getUrl(),</span><br><span class="line">                                                           helpers.analyzeResponse(messageInfo.getResponse()).getStatusCode(),</span><br><span class="line">                                                           helpers.analyzeResponse(messageInfo.getResponse()).getStatedMimeType(),</span><br><span class="line">                                                           time));</span><br><span class="line">        panel.getLogTableModel().fireTableRowsInserted(row, row);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the request map</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the request map</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">HashMap&lt;URL, Long&gt; <span class="title">getReqResMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> reqResMap;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>整体类函数功能：</strong></p>
<p>整体界面主要函数，和上一个入门篇文章中记录的编写思路是一样的，而 processHttpMessage() 的功能，主要是计算请求的URL所花费的时间，和把请求的数据进行一个储存，并且保持不会出现重复记录的情况。</p>
<p><strong>0x09 总结</strong></p>
<p>总结起来Burp插件的思路，其实就是对API接口的调用，然后进行一系列数据规则的处理，通过上面源码分析可以更便于我们自行进行造轮子和在别人轮子的基础上进行优化调整。</p>
<p>如果对于某些轮子中的函数和参数不太理解的话， 可以只用用文章一开始debug的方式，进行更加深入的了解某些参数和函数的作用，还有整个插件程序的执行顺序。</p>

      
      
        

      
    </div>
    <footer class="article-footer">
      
        <a data-url="sh1yan.top/2020/04/12/Writing-of-burpseuite-plug-in-preliminary/" data-id="ckb51hhlq0055icw16rsznl7h" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/burp/">burp</a></li></ul>


    </footer>
  </div>
  
    

  
</article>



</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 id="widget-title-about" class="widget-title">About</h3>
    <div class="widget">

<!-- 优美的分割线 -->

    <div style="width:249px;height:190px;border:1px none ;text-align:center">
  <img src="//sh1yan.top/icon.png" alt="shiyan" style="width:190px;height:190px;display:inline-block;margin:0 auto">
  </div>
<br>


<p style="font-size:15px">ID：shiyan</p>
<p style="font-size:14px">个人简介：会开挖挖机的园工~</p>
<p style="font-size:14px">
<a href="mailto:506130869@qq.com">Email：506130869@qq.com</a><br>
<a href="https://github.com/shiyan-520">GitHub：https://github.com/shiyan-520</a>
</p>


<!-- 优美的分割线 -->

      
      
      <p></p>
      
      
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 id="widget-title-tagcloud" class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/ByPass-UAC/" style="font-size: 10px;">ByPass-UAC</a> <a href="/tags/CMS/" style="font-size: 15px;">CMS</a> <a href="/tags/COM组件劫持/" style="font-size: 10px;">COM组件劫持</a> <a href="/tags/Cobalt-Strike/" style="font-size: 10px;">Cobalt Strike</a> <a href="/tags/DLL劫持/" style="font-size: 10px;">DLL劫持</a> <a href="/tags/Excel/" style="font-size: 15px;">Excel</a> <a href="/tags/JavaWeb/" style="font-size: 15px;">JavaWeb</a> <a href="/tags/Kerberos认证/" style="font-size: 10px;">Kerberos认证</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/Python3/" style="font-size: 10px;">Python3</a> <a href="/tags/UAC/" style="font-size: 10px;">UAC</a> <a href="/tags/XXE/" style="font-size: 10px;">XXE</a> <a href="/tags/access-token/" style="font-size: 10px;">access token</a> <a href="/tags/burp/" style="font-size: 20px;">burp</a> <a href="/tags/hash/" style="font-size: 10px;">hash</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jsonp/" style="font-size: 10px;">jsonp</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/metasploit/" style="font-size: 10px;">metasploit</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/sqlmap/" style="font-size: 10px;">sqlmap</a> <a href="/tags/vba/" style="font-size: 15px;">vba</a> <a href="/tags/web漏洞/" style="font-size: 15px;">web漏洞</a> <a href="/tags/令牌伪造/" style="font-size: 10px;">令牌伪造</a> <a href="/tags/博客源码/" style="font-size: 10px;">博客源码</a> <a href="/tags/博客问题解决/" style="font-size: 10px;">博客问题解决</a> <a href="/tags/反射/" style="font-size: 10px;">反射</a> <a href="/tags/域渗透/" style="font-size: 10px;">域渗透</a> <a href="/tags/学习笔记/" style="font-size: 10px;">学习笔记</a> <a href="/tags/安全审计/" style="font-size: 15px;">安全审计</a> <a href="/tags/安全服务/" style="font-size: 10px;">安全服务</a> <a href="/tags/工具分析/" style="font-size: 10px;">工具分析</a> <a href="/tags/序列化/" style="font-size: 10px;">序列化</a> <a href="/tags/感悟/" style="font-size: 15px;">感悟</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/漏洞复现/" style="font-size: 10px;">漏洞复现</a> <a href="/tags/生活记录/" style="font-size: 10px;">生活记录</a> <a href="/tags/端口转发/" style="font-size: 10px;">端口转发</a> <a href="/tags/脚本编写/" style="font-size: 10px;">脚本编写</a> <a href="/tags/部署上线/" style="font-size: 10px;">部署上线</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 id="widget-title-recent-posts" class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/07/Java-serialization-mechanism/">Java序列化机制探究</a>
          </li>
        
          <li>
            <a href="/2020/06/06/Reflection-mechanism-of-Java/">Java反射机制探究</a>
          </li>
        
          <li>
            <a href="/2020/05/30/Burpseuite-plug-in-writing-intermediate/">BurpSuite插件编写[中级篇]</a>
          </li>
        
          <li>
            <a href="/2020/05/22/Common-codes-of-pandas-in-security-audit/">安全审计之Pandas常用代码</a>
          </li>
        
          <li>
            <a href="/2020/04/12/Writing-of-burpseuite-plug-in-preliminary/">BurpSuite插件编写[初级篇]</a>
          </li>
        
      </ul>
    </div>
  </div>


  
</aside>

        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
    不要因为走了太久而忘记当初为什么出发。
    <br>
    Copyrights &copy; 2020 shiyan All Rights Reserved. 
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_uv"> 
    <a>「</a>本站访客数<span id="busuanzi_value_site_uv"></span>人次<a>」</a>
    </span></div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/gossip" class="mobile-nav-link">Gossip</a>
  
    <a href="/yqlj" class="mobile-nav-link">Links</a>
  
</nav>

    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.4";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<script src="/js/script.js"></script>


  </div>
</body>
</html>
