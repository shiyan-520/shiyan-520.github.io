<!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>漏洞学习之XXE注入 | sh1yan&#39;blog</title>

  
  <meta name="author" content="shiyan">
  

  
  <meta name="description" content="信息安全|网络安全|渗透测试|代码审计|安全审计">
  

  
  
  <meta name="keywords" content="vba,Excel">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="漏洞学习之XXE注入">

  <meta property="og:site_name" content="sh1yan&#39;blog">

  
  <meta property="og:image" content="/favicon.ico">
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="sh1yan&#39;blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
</head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">sh1yan&#39;blog</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">主页</a></li>
      
        <li><a href="/archives">归档</a></li>
      
        <li><a href="/about">关于</a></li>
      
        <li><a href="/yqlj">友联</a></li>
      
        <li><a href="/atom.xml">订阅</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>漏洞学习之XXE注入</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2019/05/04/excel-vba-1/" rel="bookmark">
        <time class="entry-date published" datetime="2019-05-04T13:52:55.000Z">
          2019-05-04
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <ol>
<li><p>在Excel中快速打开VBA编辑器</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FN+Alt+F11</span><br><span class="line">or</span><br><span class="line">选择开发选项，点击 Visual Basic</span><br></pre></td></tr></table></figure>
</li>
</ol>
<a id="more"></a>
<ol start="2">
<li><p>在VBA编辑器中摁以下按钮，切回Excel表格中</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FN+Alt+F11</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个VBA输入代码界面</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">插入→模块→插入→过程→子程序 or 函数</span><br></pre></td></tr></table></figure>
</li>
<li><p>注释</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">英文下的单引号  &apos;</span><br><span class="line">视图→工具栏→编辑</span><br></pre></td></tr></table></figure>
</li>
<li><p>相关函数的帮助</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">鼠标选中函数名+FN+F11，会弹出网页版该函数的解释</span><br></pre></td></tr></table></figure>
</li>
<li><p>代码换行<br>下划线+空格+换行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sub shiyan()</span><br><span class="line">MsgBox _ </span><br><span class="line">&quot;我叫shiyan&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>对象选择确认</p>
<p> 在操作sheet时，需要通过“视图”中的“工程资源管理器”中显示sheet序号来定。<br> 因为不这样的确认的话，程序是找不见对象的，比如你认为是sheet2，其实人家对象是sheet3.</p>
</li>
</ol>
<ol start="8">
<li><p>复制sheet1表中的数据到sheet2中（附赠一个填充语句）</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sub 填充和复制()</span><br><span class="line">&apos;Sheet1.Range(&quot;a12:a15&quot;, &quot;b12:b15&quot;) = 1</span><br><span class="line">Sheet1.Range(&quot;a1:a9&quot;).Copy Sheet3.Range(&quot;a1&quot;)</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除sheet的方法</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&apos; 删除sheet3这个表</span><br><span class="line">Sub 删除表()</span><br><span class="line">Sheet3.Delete</span><br><span class="line">End Sub</span><br><span class="line">or</span><br><span class="line">&apos; 删除排列顺序第三个的表</span><br><span class="line">Sub 删除表()</span><br><span class="line">Sheets(3).Delete</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义常量（常量是定义了之后就不做变化了）<br>常量定义格式：const 常量名 = 常量表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sub 常量()</span><br><span class="line">Const aaa = 3.14</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>定义变量（在定义之后还能再次赋值）<br>变量定义格式：dim 变量 as 变量类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Sub 变量()</span><br><span class="line">Dim aaa As Integer</span><br><span class="line">aaa = 123</span><br><span class="line">Debug.Print aaa</span><br><span class="line">aaa = 321</span><br><span class="line">Debug.Print aaa</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>注意事项1</p>
<p>VBA允许使用未定义的变量，默认是变体变量（variant）<br>因为默认的类型，开辟的空间较大，不建议使用<br>变量的强制声明：option explicit  （在代码首行定义后，如果下面的子代码不定义变量的话，就会提示编译出错）</p>
</li>
<li><p>变量的命名规则</p>
<p>已字母开头<br>不能使用保留字<br>不超过255个字符<br>同一范围内必须是唯一的</p>
</li>
<li><p>常见的数据类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">类型		注释		简写		占用内存</span><br><span class="line">integer	整型		%		2byte</span><br><span class="line">single	单精度	!		4byte</span><br><span class="line">double	双精度	#		8byte</span><br><span class="line">long		长整型	&amp;		4byte</span><br><span class="line">string	字符型	$		定长或变长</span><br><span class="line">currency	货币型	@		8byte</span><br><span class="line">Sub 定义类型()</span><br><span class="line">Dim a As Integer, b As Single, c As String</span><br><span class="line">Dim d%, e!, f$</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>IF判断语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Sub if判断1()</span><br><span class="line">Dim a%, b%</span><br><span class="line">a = 2</span><br><span class="line">b = 2</span><br><span class="line">If a = b Then MsgBox &quot;相等&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>Sub if判断2()<br>Dim a%, b%<br>a = 2<br>b = 2<br>If a = b Then</p>
<pre><code>MsgBox &quot;相等&quot;
</code></pre><p>End If<br>End Sub</p>
</li>
</ol>
<pre><code>Sub if判断3()
Dim a%, b%
a = 2
b = 3
If a = b Then
    MsgBox &quot;相等&quot;
    Else
    MsgBox &quot;不相等&quot;
End If
End Sub
</code></pre><ol start="16">
<li><p>IF判断多语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Sub if判断多条件()</span><br><span class="line">If Sheet1.Range(&quot;c3&quot;) &gt;= 90 Then</span><br><span class="line">    Sheet1.Range(&quot;c4&quot;) = &quot;优秀&quot;</span><br><span class="line">ElseIf Sheet1.Range(&quot;c3&quot;) &gt;= 80 Then</span><br><span class="line">    Sheet1.Range(&quot;c4&quot;) = &quot;良好&quot;</span><br><span class="line">ElseIf Sheet1.Range(&quot;c3&quot;) &gt;= 70 Then</span><br><span class="line">    Sheet1.Range(&quot;c4&quot;) = &quot;中等&quot;</span><br><span class="line">Else</span><br><span class="line">Sheet1.Range(&quot;c4&quot;) = &quot;较差&quot;</span><br><span class="line">End If</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>IIF函数应用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sub iif函数应用()</span><br><span class="line">Sheet1.Cells(行, 列) = IIf(Sheet1.Cells(行, 列) &gt; 80, &quot;优秀&quot;, &quot;不优秀&quot;)</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>IF用法小结</p>
<p>单行形式（if…then）<br>if 条件判断 then 条件成立结果<br>注意：在单行形式中，按照if…then判断的结果也可以执行多条语句<br>所有语句必须在同一行上并且以冒号分开</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sub test()</span><br><span class="line">If 10 &gt; 5 Then a = a + 1: b = b + 2: c = c + 3</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>Sub test()<br>If 10 &gt; 5 Then MsgBox “yes” Else MsgBox “no”<br>End Sub</p>
</li>
</ol>
<pre><code>Sub test()
If 3 &gt; 2 Then
a = 1 + 1
b = 2 + 2
c = 3 + 3
End If
End Sub
</code></pre><ol start="19">
<li><p>Select cass 语法<br>根据表达式的值来决定执行语句中的其中一个。<br>单条件判断：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sub select_case语法()</span><br><span class="line">Dim i As Integer</span><br><span class="line">i = 1</span><br><span class="line">Select Case i</span><br><span class="line">Case Is &gt; 0</span><br><span class="line">    MsgBox &quot;正数&quot;</span><br><span class="line">Case Else</span><br><span class="line">    MsgBox &quot;负数&quot;</span><br><span class="line">End Select</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>多条件判断：</p>
<pre><code>Sub select_case_多条件判断()
Select Case Sheet1.[c3].Value
Case Is &gt; 90
    Sheet1.[c4] = Sheet1.[G3]
Case Is &gt; 80
    Sheet1.[c4] = Sheet1.[G4]
Case Is &gt; 60
    Sheet1.[c4] = Sheet1.[G5]
Case Is &lt; 60
    Sheet1.[c4] = Sheet1.[G6]
End Select
End Sub
</code></pre><ol start="19">
<li><p>DO…LOOP语法</p>
<p>do…loop循环语句</p>
<p>某条件之后输入 Exit Do 结束循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sub do_loop循环()</span><br><span class="line">Dim a%</span><br><span class="line">Do</span><br><span class="line">a = a + 1</span><br><span class="line">If a &gt; 10 Then</span><br><span class="line">    MsgBox a &amp; &quot;终于大于10&quot;</span><br><span class="line">Exit Do</span><br><span class="line">End If</span><br><span class="line">Loop</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>DO…WHILE…LOOP语法</p>
<p>do…while…loop循环语句</p>
<p>条件小于某值后结束循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sub do_while_loop循环()</span><br><span class="line">Dim a%</span><br><span class="line">a = 1</span><br><span class="line">Do While a &lt; 12</span><br><span class="line">If a &gt; 10 Then</span><br><span class="line">    MsgBox a &amp; &quot;终于大于10&quot;</span><br><span class="line">End If</span><br><span class="line">a = a + 1</span><br><span class="line">Loop</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>DO…UNTIL…LOOP语法</p>
<p>do…until…loop循环语句</p>
<p>条件等于某值后结束循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sub do_until_loop循环()</span><br><span class="line">Dim a%</span><br><span class="line">a = 1</span><br><span class="line">Do Until a = 12</span><br><span class="line">If a &gt; 10 Then</span><br><span class="line">    MsgBox a &amp; &quot;终于大于10&quot;</span><br><span class="line">End If</span><br><span class="line">a = a + 1</span><br><span class="line">Loop</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>WHILE和UNTIL循环小技巧<br>while和until不但可以放在do后面，也可以放在loop后面<br>事实上有时在循环的最后一行进行判断，更有意义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Sub do_loop最后判断循环()</span><br><span class="line">Dim pass$, i!</span><br><span class="line">Do</span><br><span class="line">    pass = InputBox(&quot;请输入密码&quot;)</span><br><span class="line">Loop Until pass = &quot;123&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>Sub do_loop最后判断循环()<br>Dim pass$, i!<br>Do<br>i = i + 1<br>If i &gt; 3 Then Exit Do</p>
<pre><code>pass = InputBox(&quot;请输入密码&quot;)
</code></pre><p>Loop Until pass = “123”<br>End Sub</p>
</li>
</ol>
<ol start="23">
<li><p>FOR…EACH..NEXT循环<br>当需要处理集合成员时，一般会用for…each…next来处理对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Sub foreach_next()</span><br><span class="line">Dim rng As Range, n!</span><br><span class="line">For Each rng In Sheet1.Range(&quot;a1:a9&quot;)</span><br><span class="line">    If rng = &quot;A1&quot; Then rng.Interior.ColorIndex = 6</span><br><span class="line">Next</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>Sub foreach_next()<br>Dim wsh As Worksheet, n As Byte, m As String<br>For Each wsh In Worksheets</p>
<pre><code>n = n + 1
m = wsh.Name
Sheet1.Cells(n, 3) = m
</code></pre><p>Next<br>End Sub</p>
</li>
</ol>
<ol start="24">
<li><p>FOR…NEXT 语法<br>对数字进行累积相加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Sub for_next()</span><br><span class="line">Dim i!, j!</span><br><span class="line">For i = 1 To 10</span><br><span class="line">j = j + i</span><br><span class="line">Next</span><br><span class="line">MsgBox j</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>for语法总结<br>for …next 语句：已制定次数来重复执行一组语句<br>for 计数变量  =  初始值  to  终止值  [step 步长值]<br>[执行的一条或多条语句]<br>[exit for]<br>[执行的一条或者多条语句]<br>net [计数变量]可以忽略不写<br>循环中可以在任何位置放置任意个exit for 语句，随时退出循环<br>exit for 与if…then经常一起使用，目的是找到符合条件后，跳出循环</p>
</li>
<li><p>九九乘法表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Sub 九九乘法()</span><br><span class="line">Dim a!, b!</span><br><span class="line">For a = 1 To 9</span><br><span class="line">    For b = 1 To 9</span><br><span class="line">        If b &gt; a Then</span><br><span class="line">            Sheet1.Cells(a, b) = &quot;&quot;</span><br><span class="line">        Else</span><br><span class="line">            Sheet1.Cells(a, b) = a &amp; &quot;x&quot; &amp; b &amp; &quot;=&quot; &amp; a * b</span><br><span class="line">        End If</span><br><span class="line">    Next</span><br><span class="line">Next</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>EXIT和END的介绍<br>exit是退出当前语句</p>
<p> exit do、exit for 、exit function 、 exit sub</p>
</li>
</ol>
<p>end 结束一个过程或者块</p>
<pre><code>end 、end function、 end if 、 end select 、 end sub
</code></pre><ol start="28">
<li><p>GoTo line 跳转语句<br>goto line 无条件的转移到过程中指定的行。<br>注意，太多的 goto 语句，会使程序代码不容易阅读及调试。<br>请尽可能使用结构化控制语句（do..loop等等）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Sub gotoline()</span><br><span class="line">Dim str$</span><br><span class="line">line:</span><br><span class="line">str = InputBox(&quot;请写入名字&quot;)</span><br><span class="line">If str &lt;&gt; &quot;admin&quot; Then GoTo line</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>line 这个标识符可以是任意一个字符或者数字</p>
<pre><code>Sub gotoline()
Dim str$
shiyan:
str = InputBox(&quot;请写入名字&quot;)
If str &lt;&gt; &quot;admin&quot; Then GoTo shiyan
End Sub
</code></pre><ol start="29">
<li><p>GOSUB…RETUNRN跳转语句<br>懒得解释了，看代码吧。。。。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sub gosub_return()</span><br><span class="line">Dim i!</span><br><span class="line">For i = 1 To 9</span><br><span class="line">    If Sheet1.Range(&quot;a&quot; &amp; i) &gt; 5 Then GoSub shiyan Else Sheet1.Range(&quot;b&quot; &amp; i) = &quot;左边值小于5&quot;</span><br><span class="line">Next i</span><br><span class="line">Exit Sub</span><br><span class="line">shiyan:</span><br><span class="line">    Sheet1.Range(&quot;b&quot; &amp; i) = &quot;左边值大于5&quot;</span><br><span class="line">Return</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>错误分支语句<br>On Error Resume Next<br>但错误的时候，继续执行下去</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Sub on_error_resume_next()</span><br><span class="line">Dim i!</span><br><span class="line">On Error Resume Next</span><br><span class="line">For i = 2 To 5</span><br><span class="line">    Cells(i, 4) = Cells(i, 2) + Cells(i, 3)</span><br><span class="line">Next i</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>On Error GoTo 跳转值<br>当执行出错时，跳转到制定行</p>
<pre><code>Sub on_error_goto_str()
Dim i!
On Error GoTo shiyan
For i = 2 To 5
    Cells(i, 4) = Cells(i, 2) + Cells(i, 3)
Next
shiyan:
MsgBox &quot;出错了！&quot;
End Sub
</code></pre><ol start="31">
<li><p>with 语句<br>当对某个对象执行一系列的语句时，不用重复指出对象的名称<br>with 固定值 … end with</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Sub with赋值()</span><br><span class="line">With Range(&quot;a1&quot;)</span><br><span class="line">    a = .Address</span><br><span class="line">    b = .Parent.Name</span><br><span class="line">    .Value = &quot;1234&quot;</span><br><span class="line">End With</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>多看注释就懂了<br>Sub 双with赋值()</p>
<pre><code>With Range(&quot;a1&quot;)
    .Value = &quot;1234&quot;
    .Parent.Name = &quot;hello word&quot;
    With .Font           &apos; range(&quot;a1&quot;).font
        .Size = 20
        .Bold = True
    End With
End With
End Sub
</code></pre><ol start="32">
<li><p>一些函数语法注意项<br>当在vba代码中使用Excel函数时，当遇到函数内需要双引号时，需要填写两个双引号，即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sub 使用函数()</span><br><span class="line">Sheet1.Range(&quot;a1&quot;) = &quot;=countif(A2:a4,&quot;&quot;&gt;4&quot;&quot;)&quot;</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>一般使用Application.WorksheetFunction来借用工作表函数</p>
<pre><code>Sub 运用工作表函数()
MsgBox Application.WorksheetFunction.CountIf(Range(&quot;a1:a5&quot;), &quot;王五&quot;)
MsgBox WorksheetFunction.CountIf(Range(&quot;a1:a5&quot;), &quot;王五&quot;)
MsgBox Application.CountIf(Range(&quot;a1:a5&quot;), &quot;王五&quot;)
End Sub
</code></pre><p>直接使用vba内置的函数来操作</p>
<pre><code>Sub vba函数()
MsgBox VBA.Format(Range(&quot;d2&quot;), &quot;yyyy年m月d日&quot;)
MsgBox Format(Range(&quot;d2&quot;), &quot;yyyy年m月d日&quot;)
End Sub
</code></pre><p>自定义函数，具体用法等等以后的笔记。</p>
<pre><code>Function 自定义函数(rng As Range)
自定义函数 = IIf(rng = &quot;2&quot;, &quot;等于2&quot;, &quot;不等于2&quot;)
End Function
</code></pre><ol start="33">
<li><p>运算符<br>定义：运算符是代表vba某种运算功能的符号<br>赋值运算符：=<br>数学运算符：&amp;（字符连接符）、+（加）、-（减）、mod（取余）、\（整除）、*（乘）、/（除）、-（负号）、^（指数）<br>逻辑运算符：not（非）、and（与）、or（或）、xor（异或）、eqv（相等）、imp（隐含）<br>关系运算符：=（相同）、&lt;&gt;（不等）、&gt;（大于）、&lt;（小于）、&gt;=（不小于）、&lt;=（不大于）、like（匹配）、</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sub like_1()</span><br><span class="line">a = &quot;d&quot; Like &quot;d&quot;</span><br><span class="line">MsgBox (a)</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/学习笔记/">学习笔记</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/vba/">vba</a><a href="/tags/Excel/">Excel</a>
    </span>
    

    </div>

    
  </div>
</article>


    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    <br>
    
    &copy; 2019 shiyan
    
  </p>
</footer>
    
  </div>
</div>
</body>
</html>